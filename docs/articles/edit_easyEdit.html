<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rezonateR">
<title>Editing I: Using EasyEdit • rezonateR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Editing I: Using EasyEdit">
<meta property="og:description" content="rezonateR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rezonateR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.0000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Overview</h6>
    <a class="dropdown-item" href="../articles/overview.html">An overview of rezonateR 0.1.1</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Detailed walkthrough</h6>
    <a class="dropdown-item" href="../articles/import_save_basics.html">Importing .rez files, saving rezrObjs, and basic data structure</a>
    <a class="dropdown-item" href="../articles/time_seq.html">Time and sequence</a>
    <a class="dropdown-item" href="../articles/edit_easyEdit.html">Editing I: Using EasyEdit</a>
    <a class="dropdown-item" href="../articles/edit_tidyRez.html">Editing II: Using TidyRez</a>
    <a class="dropdown-item" href="../articles/edit_external.html">Editing III: Using external tools</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Editing I: Using EasyEdit</h1>
            
      
      
      <div class="d-none name"><code>edit_easyEdit.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="getting-started">Getting started<a class="anchor" aria-label="anchor" href="#getting-started"></a>
</h2>
<p>This vignette will use the file saved at the end of
<code><a href="../articles/time_seq.html">vignette("time_seq")</a></code>. As always, you don’t have to have
read that tutorial beforehand, though it may be helpful if you are new
to rezonateR.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rezonators.github.io/rezonateR/">rezonateR</a></span><span class="op">)</span></span>
<span><span class="va">path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"rez007_edit1.Rdata"</span>, package <span class="op">=</span> <span class="st">"rezonateR"</span>, mustWork <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/saveload.html">rez_load</a></span><span class="op">(</span><span class="va">path</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading rezrObj ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="editing-rezrdfs-some-preliminaries">Editing rezrDFs: Some preliminaries<a class="anchor" aria-label="anchor" href="#editing-rezrdfs-some-preliminaries"></a>
</h2>
<div class="section level3">
<h3 id="can-you-edit-this">Can you edit this?<a class="anchor" aria-label="anchor" href="#can-you-edit-this"></a>
</h3>
<p>As you know, editing data can be tricky. If you accidentally remove
information you should not have, the results could be disastrous. Field
access labels prevents you from accidentally changing things that you
shouldn’t be changing. Let’s look at the field access values of the
unitDF:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"fieldaccess:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "fieldaccess:"</span></span>
<span><span class="fu"><a href="../reference/getRezrDFAttr.html">fieldaccess</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span><span class="op">)</span></span>
<span><span class="co">#&gt;                 id                doc          unitStart            unitEnd </span></span>
<span><span class="co">#&gt;              "key"             "core"             "core"             "core" </span></span>
<span><span class="co">#&gt;            unitSeq                pID             unitId          unitStart </span></span>
<span><span class="co">#&gt;             "core"             "core"             "flex"             "flex" </span></span>
<span><span class="co">#&gt;              docId            unitDur           pSentSeq   unitDurSkipPause </span></span>
<span><span class="co">#&gt;             "flex"             "flex"             "flex"             "flex" </span></span>
<span><span class="co">#&gt;            unitEnd unitStartSkipPause           sequence        participant </span></span>
<span><span class="co">#&gt;             "flex"             "flex"             "flex"             "flex" </span></span>
<span><span class="co">#&gt;            turnSeq               text         transcript   docTokenSeqFirst </span></span>
<span><span class="co">#&gt;             "flex"          "foreign"          "foreign"          "foreign" </span></span>
<span><span class="co">#&gt;    docTokenSeqLast    docWordSeqFirst     docWordSeqLast </span></span>
<span><span class="co">#&gt;          "foreign"          "foreign"          "foreign"</span></span></code></pre></div>
<p>There are five possible field access values:</p>
<ul>
<li>
<code>key</code>: The primary key of the table. You are not allowed
to change it (unless you turn it into a non-key field, but this is not
encouraged since you will basically break everything). If you try to
update these fields using <code>rezonateR</code> functions, I will stop
you with an error.</li>
<li>
<code>core</code>: Core fields, mostly generated by Rezonator. You
can change them, but I will give you a warning if you do, because
changing a core field has strong potential to break things.<br>
</li>
<li>
<code>flex</code>: Flexible fields, usually fields whose values you
enter into Rezonator, though there are also flex fields automatically
generated by Rezonator.</li>
<li>
<code>auto</code>: Fields whose values are automatically generated
using information from the <strong>same</strong> rezrDF.</li>
<li>
<code>foreign</code>: Fields whose values are automatically
generated using information from a <strong>different</strong> rezrDF.
Fields like <code>text</code> and <code>tokenOrderFirst</code> in the
<code>unitDF</code> we’ve seen just before, for example, come from the
<code>entryDF</code> and are therefore <code>foreign</code> in
nature.</li>
</ul>
</div>
<div class="section level3">
<h3 id="update-functions-and-reloads">Update functions and reloads<a class="anchor" aria-label="anchor" href="#update-functions-and-reloads"></a>
</h3>
<p>Whenever you have <code>auto</code> and <code>foreign</code> fields
in a table, that means you will want them to be automatically updated as
your annotations progress. The <code><a href="../reference/reload.html">reload()</a></code> function is one of
the core features of rezonateR and allows you to do this. The
<code><a href="../reference/reload.html">reload()</a></code> feature calls functions called
<code>updateFunction</code>s. You can access the
<code>updateFunction</code>s of a table using
<code>updateFunc()</code>t:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/getRezrDFAttr.html">updateFunct</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span><span class="op">)</span></span>
<span><span class="co">#&gt; $text</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af33938&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5b1a1460&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/text"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $transcript</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af34e58&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5af34070&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/transcript"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $docTokenSeqFirst</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af3e540&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5af355c8&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/docTokenSeq"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $docTokenSeqLast</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af3fd50&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5af3f0d8&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/docTokenSeq"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $docWordSeqFirst</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af393b8&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5af38580&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/docWordSeq"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $docWordSeqLast</span></span>
<span><span class="co">#&gt; function (df, rezrObj) </span></span>
<span><span class="co">#&gt; updateLowerToHigher(df, rezrObj, address, fkeyAddress, action, </span></span>
<span><span class="co">#&gt;     field, fkeyInDF, seqName)</span></span>
<span><span class="co">#&gt; &lt;bytecode: 0x0000022c5af3c9c8&gt;</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5af39b28&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; [1] "entryDF/docWordSeq"</span></span></code></pre></div>
<p>There are three reload functions:</p>
<ul>
<li>
<code><a href="../reference/reload.html">reloadLocal()</a></code> only takes a <code>rezrDF</code>, and
only updates auto fields.</li>
<li>
<code><a href="../reference/reload.html">reloadForeign()</a></code> take a rezrDF and a rezrObj, and
updates the <code>foreign</code> fields of the rezrDF using the rezrObj
(which may or may not contain the rezrDF).</li>
<li>
<code><a href="../reference/reload.html">reload()</a></code> combines the two.</li>
</ul>
<p>Once we start editing fields, we will experience the power of
reloads. Let’s now first take a look at how we’ll be editing …</p>
</div>
</div>
<div class="section level2">
<h2 id="the-core-four">The core four<a class="anchor" aria-label="anchor" href="#the-core-four"></a>
</h2>
<p>As you probably guessed from the title, this vignette covers the
EasyEdit series of functions in <code>rezonateR</code>, which are simple
but powerful functions for editing <code>rezrDF</code>s, and can be
learnt even by users with no exposure to <code>dplyr</code>. EasyEdit
consists of four core functions, along with a bunch of useful helpers.
The four core functions are:</p>
<ul>
<li><code><a href="../reference/acFieldLocal.html">addFieldLocal()</a></code></li>
<li><code><a href="../reference/acFieldForeign.html">addFieldForeign()</a></code></li>
<li><code><a href="../reference/acFieldLocal.html">changeFieldLocal()</a></code></li>
<li>
<code><a href="../reference/acFieldForeign.html">changeFieldForeign()</a></code>.</li>
</ul>
<p>The terms ‘local’ and ‘foreign’ are inspired by, but extended from,
database terminology. They refer to what source of information you are
drawing from to create or change the field. The two ‘local’ functions
add or change fields using information from the current
<code>rezrDF</code>, and the two ‘foreign’ ones add or change fields
using information from other <code>rezrDF</code>. The word ‘local’ can
be dropped when you are using the local functions.</p>
<p>All of the four basic functions can be applied to both
<code>rezrDF</code>s and <code>rezrObj</code>s. In general, whenever you
are working with a <code>rezrObj</code> directly, it is safest to work
directly on it. However, if you are working with an emancipated
<code>rezrDF</code> - that is, a <code>rezrDF</code> stored in a
variable outside of a <code>rezrObj</code> - then you will want to apply
these functions to a single <code>rezrDF</code>. In practice, when using
these functions, the only difference between the <code>rezrDF</code> and
<code>rezrObj</code> versions is that the latter will require you to
specify entity type and layer. This tutorial will mainly use the
<code>rezrObj</code> editions; simply omit the entity type and layer
fields when applying these functions to <code>rezrDF</code>s.</p>
<p>The change functions act in more or less the same way as the add
functions, the only difference being that it works on an existing field
instead of adding a new one. So our tutorial will be mostly working with
the add functions.</p>
</div>
<div class="section level2">
<h2 id="staying-local">Staying local<a class="anchor" aria-label="anchor" href="#staying-local"></a>
</h2>
<p>Let’s start by looking at <code><a href="../reference/acFieldLocal.html">addFieldLocal()</a></code> using a simple
application: In our <code>tokenDF</code>, let’s add a field that
automatically calculates the length of a word in characters.</p>
<p>In this function, <code>entity</code> specifies the name of the
entity you would like to change, <code>layer</code> specifies the layer
within that entity (which is an empty string since there are no token
layers), <code>fieldName</code> is the name of the field we’re adding,
expression is the R expression with which we calculate the new field,
and <code>fieldaccess</code> tells rezonateR to make this an auto field
with an <code>updateFunction</code> that will be attached to the table.
Let’s try this, and look at both the results and the
<code>updateFunction</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acField.html">addField</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"token"</span>, layer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 fieldName <span class="op">=</span> <span class="st">"orthoLength"</span>,</span>
<span>                 expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span>,</span>
<span>                 fieldaccess <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"A fragment of the updated table:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A fragment of the updated table:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_select.html">rez_select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">orthoLength</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text  orthoLength</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...)           5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said            4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I               1</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"The updateFunction:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "The updateFunction:"</span></span>
<span><span class="fu"><a href="../reference/getRezrDFAttr.html">updateFunct</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span>, <span class="st">"orthoLength"</span><span class="op">)</span></span>
<span><span class="co">#&gt; function (df) </span></span>
<span><span class="co">#&gt; updateMutate(df, field, x)</span></span>
<span><span class="co">#&gt; &lt;environment: 0x0000022c5ce533b8&gt;</span></span>
<span><span class="co">#&gt; attr(,"class")</span></span>
<span><span class="co">#&gt; [1] "updateFunction" "function"      </span></span>
<span><span class="co">#&gt; attr(,"deps")</span></span>
<span><span class="co">#&gt; character(0)</span></span></code></pre></div>
<p>You might notice that <code>(...)</code> has an orthoLength of 5.
What if we decide that we don’t want to count these non-words? One
feasible solution is to use <code>isWord</code>, which we added in
<code><a href="../articles/time_seq.html">vignette("time_seq")</a></code>: if a token is a word, then we set
<code>orthoLength</code> to the number of characters in the
<code>text</code> column as before; if not, we set it to 0.</p>
<p>Although EasyEdit functions do not require users to use Tidyverse
functions, I still suggest that the Tidyverse function
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> is the best for this purpose. This
allows you to create a vector whose value can be calculated differently
depending on certain conditions. The syntax of
<code><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">dplyr::case_when()</a></code> is simple: each argument of the function
a <code>condition</code> ~ <code>value</code> pair, and if you want an
‘else’ statement, simply use <code>T</code> as the condition in the last
condition-value pair. In this case, we can use this function to create a
vector of values that is empty when a token is not a word, and the text
of the token when it <em>is</em> a word:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acField.html">changeField</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"token"</span>, layer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 fieldName <span class="op">=</span> <span class="st">"orthoLength"</span>,</span>
<span>                 expression <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">isWord</span> <span class="op">~</span> <span class="va">text</span>, <span class="cn">T</span> <span class="op">~</span> <span class="st">""</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                 fieldaccess <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"A fragment of the updated table:"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A fragment of the updated table:"</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_select.html">rez_select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">orthoLength</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text  orthoLength</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...)           0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I               1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said            4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I               1</span></span></code></pre></div>
<p>Notice that <code>(...)</code> now has an <code>orthoLength</code> of
0.</p>
<p>Now let’s spice this up a bit by adding a complex field. A complex
field takes information from multiple rows of a table. Let’s say we are
working with the <code>tokenDF</code>, but want the new column to be the
longest length of the word that appears in the unit that the token comes
from. In this case, the <code>groupField</code> argument that we haven’t
seen before is <code>unit</code>, and we specify the field type as
<code>"complex"</code>. The expression uses the function
<code><a href="../reference/complexActions.html">longestLength()</a></code>, which is a rezonateR function that returns
the longest word in a series of words.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acField.html">addField</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"token"</span>, layer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 fieldName <span class="op">=</span> <span class="st">"longestWordInUnit"</span>,</span>
<span>                 expression <span class="op">=</span> <span class="fu"><a href="../reference/complexActions.html">longestLength</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span>,</span>
<span>                 type <span class="op">=</span> <span class="st">"complex"</span>,</span>
<span>                 groupField <span class="op">=</span> <span class="st">"unit"</span>,</span>
<span>                 fieldaccess <span class="op">=</span> <span class="st">"auto"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">longestWordInUnit</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text  longestWordInUnit</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...)                 5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God                   5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,                     5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I                     7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said                  7</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I                     7</span></span></code></pre></div>
<p><code><a href="../reference/complexActions.html">longestLength()</a></code> belongs with a short collection of
functions useful for extracting information from a bunch of strings:</p>
<ul>
<li>
<code><a href="../reference/complexActions.html">shortestLength()</a></code>: Find the shortest token’s
length.</li>
<li>
<code><a href="../reference/complexActions.html">longestLength()</a></code>: Find the longest token’s length.</li>
<li>
<code><a href="../reference/complexActions.html">shortest()</a></code>: Get the shortest token’s text.</li>
<li>
<code><a href="../reference/complexActions.html">longest()</a></code>: Get the longest token’s text.</li>
<li>
<code><a href="../reference/complexActions.html">concatenateAll()</a></code>: Concatenate all the tokens
together.</li>
</ul>
<p>Some base R functions that might be useful for numeric values include
<code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max()</a></code>, <code><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min()</a></code>, <code><a href="https://rdrr.io/r/base/range.html" class="external-link">range()</a></code>,
<code><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean()</a></code>, etc.</p>
<p>Note that both times we added a field, we’ve set the field access to
<code>auto</code>. If you do not set the field access, I will
automatically set it to <code>flex</code>, which means that column -
<code>text</code> in this case - will not be affected by reloads.</p>
</div>
<div class="section level2">
<h2 id="going-foreign">Going foreign<a class="anchor" aria-label="anchor" href="#going-foreign"></a>
</h2>
<p>Now let’s add a simple foreign field. Let’s say when we look at the
tokenDF, we also want to know what the whole unit’s words are. (This
will come into handy when we want to do external editing!)</p>
<p>The trickiest part of <code>addFieldForeign</code> is keeping track
of and the target we’re aiming at. We need to know: * The source of
information that our new field is create with: this means we need to
know <code>sourceEntity</code>, <code>sourceLayer</code>,
<code>sourceFieldName</code>. * The location of our new target field:
this means we need <code>targetEntity</code>, <code>targetLayer</code>,
<code>targetFieldName</code>. * How to link the source and target
tables. This is handled by the arguent
<code>targetForeignKeyName</code>. We need to give the name of the
column containing IDs of the source table inside the target table,
i.e. the column of the target table that tells us which row of the
source table to look at. In this case the <code>unit</code> field of
tokenDF.</p>
<p>the name and location of the source and target fields, as well as
what field allows us to <em>link</em> the source and target field.
Specifically:</p>
<ul>
<li>The source is the ‘text’ field of units, so we set
<code>sourceEntity</code> to <code>"unit"</code> and
<code>sourceLayer</code> to the empty string, and
<code>sourceFieldName</code> to <code>"text"</code>.</li>
<li>The target is the ‘unitText’ field of units, so we set
<code>targetEntity</code> to <code>"token"</code> and
<code>targetLayer</code> to the empty string, and targetFieldName to
<code>"unitText"</code>.</li>
<li>The foreign key, <code>targetForeignKeyName</code>, is the
<code>unit</code> field of tokenDF.</li>
</ul>
<p>Let’s put it to practice:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acFieldForeign.html">addFieldForeign</a></span><span class="op">(</span><span class="va">rez007</span>,</span>
<span>                targetEntity <span class="op">=</span> <span class="st">"token"</span>, targetLayer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                sourceEntity <span class="op">=</span> <span class="st">"unit"</span>, sourceLayer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                targetForeignKeyName <span class="op">=</span> <span class="st">"unit"</span>,</span>
<span>                targetFieldName <span class="op">=</span> <span class="st">"unitText"</span>, sourceFieldName <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                fieldaccess <span class="op">=</span> <span class="st">"foreign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">unitText</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text  unitText                                 </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...) (...) God ,                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God   (...) God ,                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,     (...) God ,                              </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I     I said I was n't gon na do this anymore .</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said  I said I was n't gon na do this anymore .</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I     I said I was n't gon na do this anymore .</span></span></code></pre></div>
<p>Like its local counterpart, <code><a href="../reference/acFieldForeign.html">addFieldForeign()</a></code> also has a
complex flavour, i.e. we can draw from multiple lines of a different
field. This is probably the hardest part of this tutorial, so buckle
up!</p>
<p>Here, we’re going to add a field in the unitDF that tells us the
average length of words within the unit. We’re going to base this off
the <code>entryDF</code>.</p>
<p>This time, <code>targetForeignKeyName</code> works a bit differently.
Because the entries that correspond to each unit are given in the
<code>nodeMap</code>, you also need to supply the list of entries inside
a unit node - that is, <code>entryList</code>, as you may recall from
<code><a href="../articles/import_save_basics.html">vignette("import_save_basics")</a></code>.</p>
<p><code><a href="../reference/acFieldForeign.html">addFieldForeign()</a></code> has a field called
<code>complexAction</code>, which is a function performed on the source
field of the source table. The <code><a href="../reference/complexActions.html">longestLength()</a></code> series of
functions that we have seen before can be used here.:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acFieldForeign.html">addFieldForeign</a></span><span class="op">(</span><span class="va">rez007</span>,</span>
<span>                targetEntity <span class="op">=</span> <span class="st">"unit"</span>, targetLayer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                sourceEntity <span class="op">=</span> <span class="st">"entry"</span>, sourceLayer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                targetForeignKeyName <span class="op">=</span> <span class="st">"entryList"</span>,</span>
<span>                targetFieldName <span class="op">=</span> <span class="st">"averageWordLength"</span>,</span>
<span>                sourceFieldName <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                type <span class="op">=</span> <span class="st">"complex"</span>,</span>
<span>                complexAction <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nchar.html" class="external-link">nchar</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                fieldaccess <span class="op">=</span> <span class="st">"foreign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">averageWordLength</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text                                            averageWordLeng…</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2AD10A854E6D3 (...) God ,                                                 3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> BDD7D839325A  I said I was n't gon na do this anymore .                   2.82</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2752E3B395FC1 (...) &lt;0&gt; Stay up late .                                    3.17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 8487A33D1DF2  (...) &lt;0&gt; Kinda defeats the purpose of getting…             4.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 107F655C3299D (...) I know .                                              2.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 307808364906D (.) And it 's a hard habit to break .                       2.8</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="reloads-revisited">Reloads revisited<a class="anchor" aria-label="anchor" href="#reloads-revisited"></a>
</h2>
<p>Having created a bunch of auto fields, naturally we will want to try
out our reloads! Let’s try replacing the zero sign &lt;0&gt; with ∅ in
the <code>text</code> column, which is more commonly used in linguistics
papers. After doing this, we can then reload <code>unitDF</code> to look
at the impact on our freshly created <code>averageWordLength</code>.
Notice that we have to reload <code>rezrDF</code>s in order: first the
<code>entryDF</code>, using information from <code>tokenDF</code>, then
the <code>unitDF</code>, using information from <code>entryDF</code>
(please be patient if running this on your computer, since reloads can
take time):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#unitDF before the update</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"&lt;0&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_select.html">rez_select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">averageWordLength</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text                                            averageWordLeng…</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 2752E3B395FC1 (...) &lt;0&gt; Stay up late .                                    3.17</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 8487A33D1DF2  (...) &lt;0&gt; Kinda defeats the purpose of getting…             4.15</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3171F4905628A (.) If we sit down and &lt;0&gt; set some rules ,                 3   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37BE6893BC78E (H) &lt;0&gt; going to (...) our parents ,                        3.62</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 7B0D1EF95CEF  and (...) &lt;0&gt; complaining about one another ,               4.75</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1B8C3B91FA2A1 (...) &lt;MRC weekly house meetings MRC&gt; to &lt;0&gt; d…             4.58</span></span>
<span></span>
<span><span class="co">#Change the a</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op">=</span> <span class="fu"><a href="../reference/acFieldLocal.html">changeFieldLocal</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span>,</span>
<span>                                  fieldName <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                                  expression <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">text</span> <span class="op">==</span> <span class="st">"&lt;0&gt;"</span> <span class="op">~</span> <span class="st">"∅"</span>, <span class="cn">T</span> <span class="op">~</span> <span class="va">text</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">entryDF</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">entryDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/reload.html">reload</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in updateLeftJoin(df, rezrObj, address, fkey, df2key, field) : </span></span>
<span><span class="co">#&gt;   Number of foreign keys (token does not match the number of primary keys in df1 (token).</span></span>
<span><span class="co">#&gt; Error in updateLeftJoin(df, rezrObj, address, fkey, df2key, field) : </span></span>
<span><span class="co">#&gt;   Number of foreign keys (token does not match the number of primary keys in df1 (token).</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/reload.html">reload</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#unitDF after the update</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"&lt;0&gt;"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_select.html">rez_select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">averageWordLength</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 0 × 3</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 3 variables: id &lt;chr&gt;, text &lt;chr&gt;, averageWordLength &lt;dbl&gt;</span></span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="dealing-with-categorical-variables">Dealing with categorical variables<a class="anchor" aria-label="anchor" href="#dealing-with-categorical-variables"></a>
</h2>
<p>The tidyverse package <code>forcats</code> is much more powerful for
dealing with categorical variables, but for those of us who don’t want
to learn an entirely new package, <code>rezonateR</code> provides a few
easy ways to deal with categories.</p>
<p><code><a href="../reference/mergecat.html">mergeCats()</a></code> allows you to merge two categories. It takes
a vector, normally a column, as the first argument. Subsequently, the
name of each argument is a new category, and the value of each argument
is a vector of names of old categories that the new category will
encompass (as character values, even if the original column contains
factors).</p>
<p>For example, the Santa Barbara Corpus categorises laughter as
separate from other vocalisms. If you want to merge <code>"Laugh"</code>
into `“Vocalism”, keeping everything else, then you can use this
code:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Laughter tokens before</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">doc</span>, <span class="va">unit</span>, <span class="va">text</span>, <span class="va">kind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"@"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            doc    unit          text  kind </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 280154406371  sbc007 1E534FE7565B6 @     Laugh</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 8C04EB23AE43  sbc007 274331D2D2283 @@    Laugh</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 221FD665A9FA4 sbc007 EFCC48B9EDFA  @@@@@ Laugh</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15B804DDB7C66 sbc007 3759142333BAE @@@@@ Laugh</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 261421712169B sbc007 A744F59296C2  @     Laugh</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2D0821FE951A4 sbc007 273B241320492 @@@   Laugh</span></span>
<span></span>
<span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acField.html">changeField</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"token"</span>, layer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 fieldName <span class="op">=</span> <span class="st">"kind"</span>,</span>
<span>                 expression <span class="op">=</span> <span class="fu"><a href="../reference/mergecat.html">mergeCats</a></span><span class="op">(</span><span class="va">kind</span>, Vocalism <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Laugh"</span>, <span class="st">"Vocalism"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#Laughter tokens after</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">doc</span>, <span class="va">unit</span>, <span class="va">text</span>, <span class="va">kind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"@"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            doc    unit          text  kind    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 280154406371  sbc007 1E534FE7565B6 @     Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 8C04EB23AE43  sbc007 274331D2D2283 @@    Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 221FD665A9FA4 sbc007 EFCC48B9EDFA  @@@@@ Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 15B804DDB7C66 sbc007 3759142333BAE @@@@@ Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 261421712169B sbc007 A744F59296C2  @     Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2D0821FE951A4 sbc007 273B241320492 @@@   Vocalism</span></span></code></pre></div>
<p><code><a href="../reference/mergecat.html">renameCats()</a></code> has identical syntax. For example, if you
want to rename <code>Vocalism</code> further to <code>Voc</code>:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#Breath tokens before</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">doc</span>, <span class="va">unit</span>, <span class="va">text</span>, <span class="va">kind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"\\(H\\)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            doc    unit          text  kind    </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B7392EC0FE18  sbc007 1EFAE7BD41500 (H)   Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 34038223F0E2  sbc007 EDCE0A20D5B3  (H)   Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2C6A695AAE730 sbc007 3759142333BAE (H)   Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1094B3337D73D sbc007 1F858888540F6 (H)   Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 3127D3EC0E7C5 sbc007 1017EC66C38EB (H)   Vocalism</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2EA63A8716B28 sbc007 10B9591B876F8 (H)   Vocalism</span></span>
<span></span>
<span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/acField.html">changeField</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"token"</span>, layer <span class="op">=</span> <span class="st">""</span>,</span>
<span>                 fieldName <span class="op">=</span> <span class="st">"kind"</span>,</span>
<span>                 expression <span class="op">=</span> <span class="fu"><a href="../reference/mergecat.html">renameCats</a></span><span class="op">(</span><span class="va">kind</span>, Voc <span class="op">=</span> <span class="st">"Vocalism"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#Laughter tokens after</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">doc</span>, <span class="va">unit</span>, <span class="va">text</span>, <span class="va">kind</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"\\(H\\)"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            doc    unit          text  kind </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> B7392EC0FE18  sbc007 1EFAE7BD41500 (H)   Voc  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 34038223F0E2  sbc007 EDCE0A20D5B3  (H)   Voc  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 2C6A695AAE730 sbc007 3759142333BAE (H)   Voc  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1094B3337D73D sbc007 1F858888540F6 (H)   Voc  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 3127D3EC0E7C5 sbc007 1017EC66C38EB (H)   Voc  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 2EA63A8716B28 sbc007 10B9591B876F8 (H)   Voc</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="adding-rows">Adding rows<a class="anchor" aria-label="anchor" href="#adding-rows"></a>
</h2>
<p>Adding rows is not an operation you will do all the time. In general,
it is recommended to just re-import the whole thing and run all the code
again. On the occasional situation where you do have to do this,
<code><a href="../reference/addRow.html">addRow()</a></code> comes in handy.</p>
<p>You only need to add core and flex fields when you add a row. An ID
will be automatically generated, and the foreign/auto fields will be
automatically added. After specifying the rezrDF or rezrObj with entity
and layer, each argument name is a column name, and its value is the
value in the column.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/addRow.html">addRow</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="st">"trail"</span>, <span class="st">"default"</span>,</span>
<span>                doc <span class="op">=</span> <span class="st">"sbc007"</span>,</span>
<span>                chainCreateSeq <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trailDF</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">chainCreateSeq</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span>,</span>
<span>                name <span class="op">=</span> <span class="st">"Danae"</span>,</span>
<span>                chainSize <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trailDF</span><span class="op">$</span><span class="va">default</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            doc    chainCreateSeq name                      chainSize</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> E57D22CC7190  sbc007             16 time (spending)                   1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 2E79208C27DC2 sbc007             17 Ron's work                        1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 21B1DDD41EFB0 sbc007             50 impersonal you                    3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 368B8B1D9E62C sbc007             56 up there                          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 251AE6A659F6F sbc007              3 the purpose of getting up         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> LVO3QDJopkWhq sbc007             88 Danae                             1</span></span>
<span><span class="co">#Note: chainSize is currently flex as it is supplied by Rezonator and not calculated by rezonateR, but this may change in the future.</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="onwards">Onwards!<a class="anchor" aria-label="anchor" href="#onwards"></a>
</h2>
<p>The next tutorial, <code><a href="../articles/edit_tidyRez.html">vignette("edit_tidyRez")</a></code> will be
relatively short, because it will assume familiarity with the Tidyverse
package <code>dplyr</code>. If you would like to do something that goes
beyond the capabilities of <code>easyRez</code>, it is recommended that
you familiarise yourself with the relevant <code>dplyr</code> function
first, and then read the TidyRez vignette. If you are not familiar with
Tidyverse and have no intention to learn it yet, you may elect to jump
the next tutorial and go straight to
<code><a href="../articles/edit_external.html">vignette("edit_external")</a></code>.</p>
<p>And lest we forget, always save!</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">savePath</span> <span class="op">=</span> <span class="st">"rez007.Rdata"</span></span>
<span><span class="fu"><a href="../reference/saveload.html">rez_save</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="va">savePath</span><span class="op">)</span></span>
<span><span class="co">#&gt; Saving rezrObj ...</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ryan Ka Yau Lai, John W Du Bois.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.5.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
