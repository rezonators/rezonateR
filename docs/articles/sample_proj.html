<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rezonateR">
<title>Toy example of a coreference analysis in rezonateR • rezonateR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Toy example of a coreference analysis in rezonateR">
<meta property="og:description" content="rezonateR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rezonateR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.1.0000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <h6 class="dropdown-header" data-toc-skip>Overview</h6>
    <a class="dropdown-item" href="../articles/overview.html">An overview of rezonateR 0.1.1</a>
    <a class="dropdown-item" href="../articles/sample_proj.html">Toy example of a coreference analysis in rezonateR</a>
    <div class="dropdown-divider"></div>
    <h6 class="dropdown-header" data-toc-skip>Detailed walkthrough</h6>
    <a class="dropdown-item" href="../articles/import_save_basics.html">Importing .rez files, saving rezrObjs, and basic data structure</a>
    <a class="dropdown-item" href="../articles/time_seq.html">Time and sequence</a>
    <a class="dropdown-item" href="../articles/edit_easyEdit.html">Editing I: Using EasyEdit</a>
    <a class="dropdown-item" href="../articles/edit_tidyRez.html">Editing II: Using TidyRez</a>
    <a class="dropdown-item" href="../articles/edit_external.html">Editing III: Using external tools</a>
    <a class="dropdown-item" href="../articles/tree.html">Dealing with Trees</a>
    <a class="dropdown-item" href="../articles/track.html">Tracking down coreference phenomena</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Toy example of a coreference analysis in rezonateR</h1>
            
      
      
      <div class="d-none name"><code>sample_proj.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://devtools.r-lib.org/" class="external-link">devtools</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"rezonators/rezonateR"</span><span class="op">)</span></span></code></pre></div>
<p>The aim of this article is to demonstrate, using a sample, highly
simplified project, what type of analysis may be conducted using
Rezonator and <code>rezonateR</code>. This particular example will
examine the choice of referential forms in spoken dialogue: What factors
lead to the choice of a longer form (e.g. <em>the three black cats</em>)
versus a shorter one (e.g. <em>them</em>)?</p>
<p>The data here is the same as that used in the series of tutorials
starting with <code><a href="../articles/import_save_basics.html">vignette("import_save_basics")</a></code>, but this
article will have less focus on how to write the code, and more on
showing you how to answer the sample research question using
<code>rezonateR</code>.</p>
<p>This article does not assume that you have read any of the other
articles on <code>rezonateR</code>. So there is some overlap in the
topics covered. I will point you to other tutorials for further details
when necessary.</p>
<p>You are welcome to follow this tutorial in R. If you are reading this
in R using the file <code>sample_proj.Rmd</code>, you can simply click
on the ‘run’ button (green ‘play’ icon on the top right of each box). As
long as all the code blocks are run sequentially, the code should work;
otherwise, open a ticket on GitHub!</p>
<div class="section level2">
<h2 id="the-research-question">The research question<a class="anchor" aria-label="anchor" href="#the-research-question"></a>
</h2>
<p>It is often noted that in language, if a referent is more
‘accessible’, or more easily accessed mentally - for example, it is
salient in the previous discourse or physical context - then we will
tend to refer to it using a shorter and simpler form form. Things that
are less accessible - for example, things that are mentioned for the
first time - tend to be referred to using longer forms. Thus, we should
expect that in natural discourse, factors that render a referent more
accessible are associated with shorter forms, and factors that make it
less accessible are associated with longer forms.</p>
<p>But what makes something more accessible, and therefore more likely
to be referred to using a shorter form? The best way to investigate this
question is to propose some factors that may increase accessibility, and
then determine whether they are associated with the use of a shorter
form in natural discourse. This project is a preliminary investgation of
this issue using a snippet of conversation.</p>
</div>
<div class="section level2">
<h2 id="the-input-data-from-rezonator">The input data from Rezonator<a class="anchor" aria-label="anchor" href="#the-input-data-from-rezonator"></a>
</h2>
<p>The data used in this example is from the text <em>A Tree’s
Life</em>, a conversation between two sisters from the Santa Barbara
Corpus of Spoken American English. The first 162 lines have been
annotated here, which deals with the topic of one of the sisters’
roommates.</p>
<p>The file has been annotated for coreference (trails), resonance, as
well as argument structure (through trees). For this tutorial, resonance
will be ignored. Coreference chains include referential expressions
along with non-referring expressions that have been otherwise referred
back to (e.g. discourse deixis). Figure 1 shows an example of the data
in the Rezonator interface:</p>
<div class="figure">
<img src="img/sample_sbc007.PNG" style="width:100.0%" alt=""><p class="caption">Figure 1</p>
</div>
<p>Wavy lines indicate coreference links. Each mention or referential
expression is a <em>track</em> inside the larger trail. These
expressions all form tracks that are part of the trail for Mary:</p>
<div class="figure">
<img src="img/sample_track.PNG" style="width:100.0%" alt=""><p class="caption">Figure 2</p>
</div>
<p>In this file, entire clauses that serve as antecedents in cases of
discourse deixis are also considered tracks. For example, notice that
the two occurrences of <em>I</em> on Line 2 are linked together with a
purple link, along with the zero on line 3.</p>
<p>Two-layered trees indicate argument structure of each verb. The
verbal complex (including auxiliaries and adverbs that intervene between
the auxiliary and verb, but not arguments that intervene between
auxiliary and verb) is annotated as blank chunks (with chunkType =
“verb”) and serves as the root of each tree. Tree links are annotated as
Relation = “Subject” when it indicates a subject-verb relation;
otherwise Relation is left blank. For example, the tree panel of Figure
3 shows the argument structure of Line 4, with <em>defeats</em> as the
root with three children: a zero subject, the object <em>the purpose of
getting up in the morning</em>, and the adverb <em>kinda</em>:</p>
<div class="figure">
<img src="img/sample_tree.PNG" style="width:100.0%" alt=""><p class="caption">Figure 3</p>
</div>
<p>There are two types of chunks (elements represented by rectangles) in
this file: Chunks that have been created as part of a trail (mostly
referential expressions - such as <em>the purpose of getting up in the
morning</em> the example), and verbs, which are ‘blank chunks’, i.e. do
not belong to any trail and appear with grey borders (such as
<em>said</em> in the example). Chunks have been annotated for two
properties: <code>chunkType</code> (which is <code>verb</code> for verbs
and left blank for referential expressions) and
<code>largerChunk</code>, i.e. the larger chunk to which a chunk
belongs. Note that <code>number</code> is NOT annotated; it will instead
be annotated with the help of <code>rezonateR</code>.</p>
<div class="figure">
<img src="img/sample_chunk.PNG" style="width:100.0%" alt=""><p class="caption">Figure 4</p>
</div>
<div class="section level3">
<h3 id="our-goal-in-rezonater">Our goal in rezonateR<a class="anchor" aria-label="anchor" href="#our-goal-in-rezonater"></a>
</h3>
<p>As we said above, our goal is to determine whether several factors
that are proposed to be relevant to accessibility are associated with
shorter referential forms.</p>
<p>To this end, we will be buildiong a model that predicts the
<code>charCount</code>, i.e. length (in number of characters) of a
certain referential expression. Several predictors will be used to
predict <code>charCount</code> in our small dataset. Here is a spoiler
of the final set of factors:</p>
<ul>
<li>
<code>noPrevSubjMentionsIn10</code>: The number of coreferent
subject mentions within the 10 previous intonation units. That is, how
many times was the referent of a form mentioned in the 10 previous
intonation units in subject position?</li>
<li>
<code>noPrevNonSubjMentionsIn10</code>: The number of coreferent
non-subject mentions within the 10 previous units. That is, how many
times was the referent of a form mentioned in the 10 previous intonation
units, outside of subject position?</li>
<li>
<code>gapUnits</code>: How many units are there between the previous
mention and the current one?</li>
<li>
<code>noCompetitors</code>: The number of competitors within the
five previous units. That is, how many times were entities other than
the referent of the current referential expression mentioned within the
five previous intonation units?</li>
<li>
<code>Relation</code>: Is the current referential expression a
subject?</li>
<li>
<code>isPredOrFree</code>: Is the current mention either a nominal
predicate (copula complement) or not tied to a particular clause?</li>
<li>
<code>number</code>: Is the current referential expression singular
or plural?</li>
</ul>
<p>Thus, our goal within R is to create a data frame where each row
corresponds to a referential expresssion, and the columns include all of
these factors (plus <code>charCount</code>, the number of characters).
This can be done easily using the <code>rezonateR</code> functions after
inputting the raw Rezonator data.</p>
</div>
</div>
<div class="section level2">
<h2 id="importing-the-file">Importing the file<a class="anchor" aria-label="anchor" href="#importing-the-file"></a>
</h2>
<p>The first step is to import the file. When importing a file, an
object called <code>rezrObj</code> is created. <code>rezrObj</code>
contains two kinds of elements:</p>
<ul>
<li>A <code>nodeMap</code>, which contains the data in the form of a
series of interconnected nodes with attributes</li>
<li>A series of <code>rezrDF</code>s, which are data frames containing
information about different elements of the file.</li>
</ul>
<p>Some important <code>rezrDF</code>s include: <code>tokenDF</code>,
which contains the information about individual tokens of the original
file, <code>chunkDF</code>, which contains information about chunks,
<code>trackDF</code>, which contains information about entries of trails
(i.e. mentions in coreference chains), and <code>treeEntryDF</code>,
which contains information about entries on a tree.</p>
<p>Here’s the import code. It contains two kinds of information:</p>
<ul>
<li>How to divide the chunks into layers. Here, we divide the chunks
into two layers, <code>verb</code> and <code>refexpr</code> (for
‘referential expressions’, including the entire clauses we’ve seen
before). Chunks in the two layers are put into two separate
<code>rezrDF</code>s. Since no layers are specified for
<code>trackDF</code> and <code>treeDF</code>, there will be only one
<code>rezrDF</code> for them, with the layer name
<code>default</code>.</li>
<li>Which fields of a token contains text to be concatenated in
<code>concatFields</code>. The fields <code>text</code> and
<code>transcript</code> of the Santa Barbara Corpus are concatenated to
form <code>text</code> and <code>transcript</code> fields of larger
structures like units and chunks. Telling this information to
<code>rezonateR</code> is important for the text to appear in tables
like <code>chunkDF</code> or <code>unitDF</code>.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rezonators.github.io/rezonateR/">rezonateR</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: readr</span></span>
<span><span class="co">#&gt; Loading required package: stringr</span></span>
<span><span class="co">#&gt; Loading required package: rlang</span></span>
<span><span class="va">path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"sbc007.rez"</span>, package <span class="op">=</span> <span class="st">"rezonateR"</span>, mustWork <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span></span>
<span><span class="va">layerRegex</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>chunk <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>field <span class="op">=</span> <span class="st">"chunkType"</span>,</span>
<span>                               regex <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"verb"</span><span class="op">)</span>,</span>
<span>                               names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"verb"</span>, <span class="st">"refexpr"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">concatFields</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"text"</span>, <span class="st">"transcript"</span><span class="op">)</span></span>
<span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/importRez.html">importRez</a></span><span class="op">(</span><span class="va">path</span>,</span>
<span>                   layerRegex <span class="op">=</span> <span class="va">layerRegex</span>,</span>
<span>                   concatFields <span class="op">=</span> <span class="va">concatFields</span><span class="op">)</span></span>
<span><span class="co">#&gt; Import starting - please be patient ...</span></span>
<span><span class="co">#&gt; Creating node maps ...</span></span>
<span><span class="co">#&gt; Creating rezrDFs ...</span></span>
<span><span class="co">#&gt; Adding foreign fields to rezrDFs and sorting (this is the slowest step) ...</span></span>
<span><span class="co">#&gt; &gt;Adding to unit entry DF ...</span></span>
<span><span class="co">#&gt; &gt;Adding to unit DF ...</span></span>
<span><span class="co">#&gt; &gt;Adding to chunk DF ...</span></span>
<span><span class="co">#&gt; &gt;Adding to track DFs ...</span></span>
<span><span class="co">#&gt; &gt;Adding to track DFs ...</span></span>
<span><span class="co">#&gt; &gt;Adding to tree DFs ...</span></span>
<span><span class="co">#&gt; Splitting rezrDFs into layers ...</span></span>
<span><span class="co">#&gt; A few finishing touches ...</span></span>
<span><span class="co">#&gt; Done!</span></span></code></pre></div>
<p>As examples of the content inside the imported object, here are the
imported <code>chunkDF</code> members and <code>trackDF</code>:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">)</span></span>
<span><span class="co">#&gt; $refexpr</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 64 × 23</span></span></span>
<span><span class="co">#&gt;    id          doc   name   nest kind  place text  trans…¹ endNote order negPl…²</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 35E3E0AB68… sbc0… Chun…     2 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    Stay… Stay u… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1F6B5F0B3F… sbc0… Chun…     3 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    the … the pu… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 24FE2B219B… sbc0… Chun…     2 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    gett… gettin… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 158B579C1B… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    the … the mo… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2B6521E881… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    all … all th… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 5B854594DD… sbc0… Chun…     2 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    the … the wa… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 189552EBB1… sbc0… Chun…     2 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    the … the on… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 313D141E6D… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    the … the ho… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1E970FF5D9… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    all … all th… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 85C4F230E6… sbc0… Chun…     2 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    what… what t… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 54 more rows, 12 more variables: corpusSeq &lt;chr&gt;, pSentOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   POS_dft &lt;chr&gt;, tokenSeq &lt;chr&gt;, chunkType &lt;chr&gt;, turnOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   largerChunk &lt;chr&gt;, tokenOrderFirst &lt;dbl&gt;, docTokenSeqFirst &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tokenOrderLast &lt;dbl&gt;, docTokenSeqLast &lt;dbl&gt;, layer &lt;chr&gt;, and abbreviated</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   variable names ¹​transcript, ²​negPlace</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $verb</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 132 × 23</span></span></span>
<span><span class="co">#&gt;    id          doc   name   nest kind  place text  trans…¹ endNote order negPl…²</span></span>
<span><span class="co">#&gt;  <span style="color: #BCBCBC;">*</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 210FB26A31… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    said  said    <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 744AD104FE… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    was … was n'… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 15B9BB5D50… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    Stay  Stay    <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1A14BB68ED… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    defe… defeats <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2CCD5F5A95… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    know  know    <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1F1135429F… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    's    's      <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2F857247FD… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    a ha… a hard… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 30F18BABDB… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    do n… do n't] <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 94188DEA38… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    is    i:s]    <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 13A37EC506… sbc0… Chun…     1 <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>    do n… do n't… <span style="color: #949494;">""</span>      <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 122 more rows, 12 more variables: corpusSeq &lt;chr&gt;, pSentOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   POS_dft &lt;chr&gt;, tokenSeq &lt;chr&gt;, chunkType &lt;chr&gt;, turnOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   largerChunk &lt;chr&gt;, tokenOrderFirst &lt;dbl&gt;, docTokenSeqFirst &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   tokenOrderLast &lt;dbl&gt;, docTokenSeqLast &lt;dbl&gt;, layer &lt;chr&gt;, and abbreviated</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   variable names ¹​transcript, ²​negPlace</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `print(n = ...)` to see more rows, and `colnames()` to see all variable names</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 31</span></span></span>
<span><span class="co">#&gt;   id       doc   chain sourc…¹ token gapWo…² charC…³ token…⁴ gapUn…⁵ kind  place</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1096E4A… sbc0… 278D… <span style="color: #949494;">""</span>      37EF… N/A           1       1 N/A     <span style="color: #949494;">"</span>Wor… <span style="color: #949494;">"</span>1<span style="color: #949494;">"</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 92F20AC… sbc0… 278D… <span style="color: #949494;">"</span>174E6… 9363… 2             1       1 0       <span style="color: #949494;">"</span>Wor… <span style="color: #949494;">"</span>3<span style="color: #949494;">"</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7E5BB65… sbc0… 2B67… <span style="color: #949494;">""</span>      744A… N/A          17       5 N/A     <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1F74D2B… sbc0… 2A01… <span style="color: #949494;">"</span>52452… 1265… N/A           4       1 N/A     <span style="color: #949494;">"</span>Wor… <span style="color: #949494;">"</span>9<span style="color: #949494;">"</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2485C4F… sbc0… 278D… <span style="color: #949494;">"</span>CB1D9… 2113… 10            3       1 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1BF2260… sbc0… 2A01… <span style="color: #949494;">""</span>      35E3… 5            12       3 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 20 more variables: text &lt;chr&gt;, transcript &lt;chr&gt;, endNote &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   order &lt;chr&gt;, negPlace &lt;chr&gt;, corpusSeq &lt;chr&gt;, pSentOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   POS_dft &lt;chr&gt;, tokenSeq &lt;chr&gt;, chunkType &lt;chr&gt;, turnOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   largerChunk &lt;chr&gt;, tokenOrderFirst &lt;dbl&gt;, tokenOrderLast &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   docTokenSeqFirst &lt;dbl&gt;, docTokenSeqLast &lt;dbl&gt;, chainCreateSeq &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   name &lt;chr&gt;, chainSize &lt;dbl&gt;, layer &lt;chr&gt;, and abbreviated variable names</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ¹​sourceLink, ²​gapWords, ³​charCount, ⁴​tokenCount, ⁵​gapUnits</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre></div>
<p>More information about the import process and the various objects
created can be found in <code><a href="../articles/import_save_basics.html">vignette("import_save_basics")</a></code>.</p>
<p>Each line of the table <code>rez007$trackDF$default</code> contains a
referential expression whose size we want to predict. The goal of using
<code>rezonateR</code> for this project will be to produce a version of
the data frame <code>rez007$trackDF</code> that contains all the
predictors and the dependent variable on each line, and may be fed to
models such as <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm()</a></code>.</p>
<p>You can save the <code>rezrObj</code> with <code><a href="../reference/saveload.html">rez_save()</a></code> so
that it can be opened with <code><a href="../reference/saveload.html">rez_load()</a></code> next time, saving you
the trouble of importing again:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">savePath</span> <span class="op">=</span> <span class="st">"rez007.Rdata"</span></span>
<span><span class="fu"><a href="../reference/saveload.html">rez_save</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="va">savePath</span><span class="op">)</span></span>
<span><span class="co">#&gt; Saving rezrObj ...</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="augmenting-the-file-with-basic-information-about-order-and-sequence">Augmenting the file with basic information about order and
sequence<a class="anchor" aria-label="anchor" href="#augmenting-the-file-with-basic-information-about-order-and-sequence"></a>
</h2>
<p>After importing the file, there are a few simple operations that we
usually call to add additional information to the table which was not
added during the original import process, before beginning the process
of editing.</p>
<div class="section level3">
<h3 id="words-vs-tokens">Words vs tokens<a class="anchor" aria-label="anchor" href="#words-vs-tokens"></a>
</h3>
<p>By default Rezonator provides two fields related to the position of a
token, which you will see in <code>tokenDF</code> as columns:</p>
<ul>
<li>
<code>docTokenSeq</code> - refers to the order of a token within the
entire text</li>
<li>
<code>tokenOrder</code> - refers to the position of a token within
its intonation unit</li>
</ul>
<p>Structures that span multiple tokens, like chunks and units, have
four token sequence-related fields:</p>
<ul>
<li>
<code>docTokenSeqFirst</code> - refers to the
<code>docTokenSeq</code> of the first token.</li>
<li>
<code>docTokenSeqLast</code> - refers to the
<code>docTokenSeq</code> of the last token.</li>
<li>
<code>tokenOrderFirst</code> - refers to the <code>tokenOrder</code>
of the first token.</li>
<li>
<code>tokenOrderLast</code> - refers to the <code>tokenOrder</code>
of the last token.</li>
</ul>
<p>Here are some examples:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">tokenOrder</span>, <span class="va">docTokenSeq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   id            text  tokenOrder docTokenSeq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...)          1           1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God            2           2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,              3           3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I              1           4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said           2           5</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I              3           6</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">$</span><span class="va">refexpr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">tokenOrderFirst</span>, <span class="va">tokenOrderLast</span>,  <span class="va">docTokenSeqFirst</span>, <span class="va">docTokenSeqLast</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 6</span></span></span>
<span><span class="co">#&gt;   id            text                             token…¹ token…² docTo…³ docTo…⁴</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 35E3E0AB6803A Stay up late                           3       5      17      19</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1F6B5F0B3FF59 the purpose of getting up in th…       5      12      25      32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 24FE2B219BD21 getting up in the morning              8      12      28      32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 158B579C1BA49 the morning                           11      12      31      32</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2B6521E881365 all this other shit                    2       5     144     147</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5B854594DD34  the way (...) they were feeling        5      10     156     161</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable names ¹​tokenOrderFirst, ²​tokenOrderLast,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   ³​docTokenSeqFirst, ⁴​docTokenSeqLast</span></span></span></code></pre></div>
<p>These values count all tokens in the file. In the Santa Barbara
Corpus text we are using, this includes endnotes (such as <code>,</code>
and <code>.</code>), transcriptions of vocalisms (such as
<code>(H)</code> for in-breaths and <code>@@@</code> for laughter), and
so on. What if we want a version of fields like <code>tokenOrder</code>
and <code>docTokenSeq</code> that excludes these, including just ‘real’
words like <em>person</em> and <em>love</em>? We can use the function
<code><a href="../reference/addIsWordField.html">addIsWordField()</a></code>:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/addIsWordField.html">addIsWordField</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="va">kind</span> <span class="op">==</span> <span class="st">"Word"</span><span class="op">)</span></span></code></pre></div>
<p>This adds the fields <code>wordOrder</code> and
<code>docWordSeq</code> to <code>tokenDF</code> (and also its
counterparts in places like <code>chunkDF</code> and
<code>unitDF</code>, e.g. <code>wordOrderFirst</code>,
<code>wordOrderLast</code>, <code>docWordSeqFirst</code>,
<code>docWordSeqLast</code>). These new fields discount non-real words,
which get the value <code>0</code>. Here’s an example in
<code>tokenDF</code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">tokenOrder</span>, <span class="va">docTokenSeq</span>, <span class="va">wordOrder</span>, <span class="va">docWordSeq</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            tokenOrder docTokenSeq wordOrder docWordSeq</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E          1           1         0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7          2           2         1          1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05          3           3         0          0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691          1           4         1          2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1          2           5         2          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59           3           6         3          4</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="unit-sequence-information">Unit sequence information<a class="anchor" aria-label="anchor" href="#unit-sequence-information"></a>
</h3>
<p>Information about the location of elements other than tokens inside
units is not included by default. The function <code><a href="../reference/addUnitSeq.html">addUnitSeq()</a></code>
does this. Here, <code>unitSeqFirst</code> and <code>unitSeqLast</code>
are added to <code>chunkDF</code> and <code>trackDF</code>, allowing us
to see which units chunks and tracks belong to:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/addUnitSeq.html">addUnitSeq</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="st">"track"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">$</span><span class="va">refexpr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">unitSeqFirst</span>, <span class="va">unitSeqLast</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   id            text                                     unitSeqFirst unitSeqL…¹</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 35E3E0AB6803A Stay up late                                        3          3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1F6B5F0B3FF59 the purpose of getting up in the morning            4          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 24FE2B219BD21 getting up in the morning                           4          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 158B579C1BA49 the morning                                         4          4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2B6521E881365 all this other shit                                24         24</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5B854594DD34  the way (...) they were feeling                    26         26</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​unitSeqLast</span></span></span></code></pre></div>
<p>For the details of these functions, see
<code><a href="../articles/time_seq.html">vignette("time_seq")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="pass-1-predicting-length-from-lookback-distance">Pass 1: Predicting length from lookback distance<a class="anchor" aria-label="anchor" href="#pass-1-predicting-length-from-lookback-distance"></a>
</h2>
<div class="section level3">
<h3 id="gapunits-lookback-distance-in-r">
<code>gapUnits</code>: Lookback distance in R<a class="anchor" aria-label="anchor" href="#gapunits-lookback-distance-in-r"></a>
</h3>
<p>As you may have noticed when using Rezonator, Rezonator automatically
calculates the number of distances from each track (mention) to the
previous mention in the same trail (coreference chain). This is called
<code>gapUnits</code>, and it is automatically imported from Rezonator
into rezonateR in <code>trackDF</code>. The <code>gapUnits</code> value
is <code>N/A</code> for first mentions of things; otherwise it is a
nonnegative integer.</p>
<p>Because first mentions are usually not accessible in discourse when
they are first introduced, we can expect that they would be referred to
using heavier noun phrases. Let’s try to verify that this is the case.
(This tutorial will use some Tidyverse functions, such as those from
<code>ggplot2</code>; feel free to click on any functions that you do
not recognise to see their documentation).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'ggplot2'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:rezonateR':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     %+%</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>isFirst <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span><span class="va">gapUnits</span> <span class="op">==</span> <span class="st">"N/A"</span> <span class="op">~</span> <span class="st">"First"</span>,</span>
<span>                             <span class="cn">T</span> <span class="op">~</span> <span class="st">"NonFirst"</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">isFirst</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Clearly, we can see that first mentions have a much higher tendency
to be referred to using a noun phrase that has more characters.</p>
<p>Among the non-first mentions, can we also predict whether the
character count from <code>gapUnits</code>? Let’s again do a quick
visualisation. If we exclude non-first mentions, and plot the
relationship betwee <code>gapUnits</code> and <code>charCount</code>,
this is what we get:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapUnits</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapUnits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">gapUnits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gapUnits</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<p>Oh no, what’s going on? It seems that <code>gapUnits</code> is not
predicting what we would usually expect to see. Most of the long
<code>gapUnits</code> noun phrases are fairly light, and there are quite
a few small <code>gapUnits</code> phrases that are quite long.</p>
<p>In the rest of the tutorial, we will partially account for this
weirdness (though some of it is certainly due to our small, biased
dataset). But for now, let’s try to apply a simple linear model to this
data to see what happens when we try to predict <code>charCount</code>
from <code>gapUnits</code>. (Note: This is not the best model for the
model specification we’re looking at, but let’s keep it simple for this
tutorial.)</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass1_model1</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapUnits</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapUnits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">gapUnits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">gapUnits</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass1_model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ gapUnits, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -5.656 -4.534 -3.534 -1.952 43.466 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  6.65576    0.85118   7.819  6.4e-13 ***</span></span>
<span><span class="co">#&gt; gapUnits    -0.12170    0.09148  -1.330    0.185    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.517 on 162 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.01081,    Adjusted R-squared:  0.0047 </span></span>
<span><span class="co">#&gt; F-statistic:  1.77 on 1 and 162 DF,  p-value: 0.1853</span></span></code></pre></div>
<p>As we can see, although there is a negative coefficient that says a
larger <code>gapUnits</code> leads to a smaller character count (as
expected), it is not significant.</p>
</div>
<div class="section level3">
<h3 id="a-finer-grained-distance-metric">A finer-grained distance metric?<a class="anchor" aria-label="anchor" href="#a-finer-grained-distance-metric"></a>
</h3>
<p>There is another value, <code>gapWords</code>, that is automatically
calculated in Rezonator and calculates the number of tokens from the
current mention to the previous one. Would this finer-grained measure do
better than <code>gapUnits</code>? Let’s try:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapWords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">gapWords</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gapWords</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass1_model2</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapWords <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">gapWords</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">gapWords</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass1_model2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ gapWords, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -5.623 -4.544 -3.475 -1.999 43.397 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;             Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)  6.66260    0.85391   7.802 7.06e-13 ***</span></span>
<span><span class="co">#&gt; gapWords    -0.01974    0.01486  -1.329    0.186    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.517 on 162 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.01079,    Adjusted R-squared:  0.004679 </span></span>
<span><span class="co">#&gt; F-statistic: 1.766 on 1 and 162 DF,  p-value: 0.1857</span></span></code></pre></div>
<p>The pattern is not much clearer from the diagram this time than last
time, and there is little change with the linear model either: The
p-value is still around 0.2.</p>
<p>There are ways we can potentially improve on these measures as well
as other predictors of character count that we can potentially explore.
We’ll continue doing this throughout the tutorial.</p>
</div>
</div>
<div class="section level2">
<h2 id="pass-2-adding-predictors-with-easytrack">Pass 2: Adding predictors with EasyTrack<a class="anchor" aria-label="anchor" href="#pass-2-adding-predictors-with-easytrack"></a>
</h2>
<p>Having attempted to predict character count from predictors imported
directly from Rezonator, let’s try to derive some predictors using
<code>rezonateR</code> functions. This section will cover some basic
functions in the <code>EasyTrack</code> series of functions. See
<code><a href="../articles/track.html">vignette("track")</a></code> for details about them.</p>
<div class="section level3">
<h3 id="counting-previous-mentions">Counting previous mentions<a class="anchor" aria-label="anchor" href="#counting-previous-mentions"></a>
</h3>
<p>The function <code><a href="../reference/trackPrevContext.html">countPrevMentions()</a></code> in
<code>rezonateR</code> is one function we can use. In its simplest form,
you can simply specify a window of units in which to look for
referential expressions that corefer with the each mention. We will look
at the 10 previous units. We will add this value to the
<code>trackDF</code> using the <code><a href="../reference/rez_mutate.html">rez_mutate()</a></code> function, which
is part of the TidyRez family (<code><a href="../articles/edit_tidyRez.html">vignette("edit_tidyRez")</a></code>).
(We use this function rather than <code><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">dplyr::mutate()</a></code> in order
to ensure that the resulting data frame will remain in the correct
<code>rezonateR</code> format.) Here is the code, along with a line of
code that displays the first couple of values of this predictor:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>noPrevMentionsIn10 <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">countPrevMentions</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">noPrevMentionsIn10</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">#&gt;    id            text                                     noPrevMentionsIn10</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1096E4AFFFE65 I                                                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 92F20ACA5F06  I                                                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7E5BB65072C   was n't gon na do                                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1F74D2B049FA4 this                                                      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2485C4F740FC0 &lt;0&gt;                                                       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1BF2260B4AB78 Stay up late                                              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6B37B5A80F2A  &lt;0&gt;                                                       2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 259C2C2979B6C the purpose of getting up in the morning                  0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1D1F2B7054E32 getting up in the morning                                 0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1FA3806680C84 the morning                                               0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4B32FD84BA10  I                                                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 3098AB24A0FA6 it                                                        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2D5885FCA1E15 a hard habit to break                                     0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1C311FD331AC4 I                                                         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2E01153F693D3 It                                                        4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 28CFE0272CE1C I                                                         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 24229602BDC4C I                                                         3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1A598AE39592B midnight                                                  0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 38C628AB4DA4D What                                                      0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 36B8918BB6E64 I                                                         2</span></span></code></pre></div>
<p>Now let’s try to draw a scatterplot and fit a linear model plotting
this predictor against <code>charCount</code>, as we have done
before:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">noPrevMentionsIn10</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass2_model1</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noPrevMentionsIn10</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass2_model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noPrevMentionsIn10, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -6.839 -4.592 -3.341 -1.094 45.157 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)          7.8389     1.1146   7.033 5.38e-11 ***</span></span>
<span><span class="co">#&gt; noPrevMentionsIn10  -0.7489     0.3607  -2.076   0.0394 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.444 on 162 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.02592,    Adjusted R-squared:  0.01991 </span></span>
<span><span class="co">#&gt; F-statistic: 4.311 on 1 and 162 DF,  p-value: 0.03945</span></span></code></pre></div>
<p>From the graph, we see that there <em>is</em> a tendency for
character counts to be smaller when the number of previous mentions is
greater, albeit somewhat weak. The very large referential expressions
are absent when there are more than 5 previous mentions, and after about
five mentions, we can see the modal character length decreasing as well.
From the linear model, We also find that the number of previous mentions
in the previous 10 units <em>is</em> a significant predictor at the 0.05
significance level.</p>
</div>
<div class="section level3">
<h3 id="counting-competitors">Counting competitors<a class="anchor" aria-label="anchor" href="#counting-competitors"></a>
</h3>
<p>The function <code><a href="../reference/countCompete.html">countCompetitors()</a></code> is similar to
<code>countPreviousMentions()</code>, except that it counts the number
of referential expressions that are <em>not</em> in the same coreference
chain, i.e. compete for the interlocutors’ attention. The syntax is
similar to <code>countPreviousMentions()</code>, with the extra argument
<code>between</code>, which specifies whether you want to count only
expressions between the current mention and the previous one. We will
add this value to the <code>trackDF</code> using the
<code><a href="../reference/rez_mutate.html">rez_mutate()</a></code> function again. So let’s try to add the number
of competitors now:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>noCompetitors <span class="op">=</span> <span class="fu"><a href="../reference/countCompete.html">countCompetitors</a></span><span class="op">(</span>windowSize <span class="op">=</span> <span class="fl">10</span>, between <span class="op">=</span> <span class="cn">F</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">noCompetitors</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 2</span></span></span>
<span><span class="co">#&gt;    id            noCompetitors</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                 <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1096E4AFFFE65             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 92F20ACA5F06              0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7E5BB65072C               2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1F74D2B049FA4             3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2485C4F740FC0             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1BF2260B4AB78             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6B37B5A80F2A              1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 259C2C2979B6C             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1D1F2B7054E32             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1FA3806680C84             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4B32FD84BA10              3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 3098AB24A0FA6             4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2D5885FCA1E15             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1C311FD331AC4             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2E01153F693D3             2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 28CFE0272CE1C             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 24229602BDC4C             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1A598AE39592B             1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 38C628AB4DA4D             0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 36B8918BB6E64             1</span></span></code></pre></div>
<p>Now let’s try to draw a scatterplot and fit a linear model, as we
have done before:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">noCompetitors</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass2_model1</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass2_model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -9.349 -4.503 -2.887 -0.887 39.651 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;               Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)     3.8873     1.1854   3.279  0.00127 **</span></span>
<span><span class="co">#&gt; noCompetitors   1.6155     0.6782   2.382  0.01838 * </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.406 on 162 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.03384,    Adjusted R-squared:  0.02787 </span></span>
<span><span class="co">#&gt; F-statistic: 5.673 on 1 and 162 DF,  p-value: 0.01838</span></span></code></pre></div>
<p>From the graph, there does seem to be a small effect where a greater
number of competitors leads to the use of fewer characters. This effect
again turns out to be significant at the 0.05 significance level.</p>
<p>However, there is good reason to believe that
<code>noCompetitors</code> and <code>noPrevMentionsIn10</code> may be
highly correlated, and thus some of the effect we see for
<code>noCompetitors</code> may actually due to the presence of previous
mentions, or vice versa. This is because of there are more
non-coreferring expressions in the previous units, there will tend to be
fewer coreferring expressions, assuming that the number of referential
expressions is relatively stable, i.e. our two competitors are
negatively correlated are negatively correlated. The code below plots
them in a graph and calculates the Pearson correlation coefficient,
which is somewhat negative:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">noCompetitors</span>, y <span class="op">=</span> <span class="va">noPrevMentionsIn10</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/cor.html" class="external-link">cor</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">noCompetitors</span>, <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span><span class="op">$</span><span class="va">noPrevMentionsIn10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -0.2175647</span></span></code></pre></div>
<p>So let’s try to put both in the model and how the results turn
out:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass2_model3</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass2_model3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10, </span></span>
<span><span class="co">#&gt;     data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -9.512 -4.538 -2.792 -0.424 41.274 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)          5.5909     1.5766   3.546 0.000512 ***</span></span>
<span><span class="co">#&gt; noCompetitors        1.3792     0.6902   1.998 0.047390 *  </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10  -0.5953     0.3656  -1.628 0.105396    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.358 on 161 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.04949,    Adjusted R-squared:  0.03768 </span></span>
<span><span class="co">#&gt; F-statistic: 4.191 on 2 and 161 DF,  p-value: 0.01681</span></span></code></pre></div>
<p>As we can see, once we put both in the model,
<code>noCompetitors</code> becomes the only significant predictor. (Of
course, this does not mean that <code>noPrevMentionsIn10</code> does not
matter; we only have very low power, after all.)</p>
<p>As a last attempt, let’s also try the lookback-based approach by
adding <code>gapUnits</code> to the model as well:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass2_model4</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapUnits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">gapUnits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnits</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass2_model4</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10 + </span></span>
<span><span class="co">#&gt;     gapUnits, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.669  -4.782  -2.812   0.190  40.400 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)          7.2225     1.6711   4.322 2.71e-05 ***</span></span>
<span><span class="co">#&gt; noCompetitors        1.5960     0.6833   2.336   0.0207 *  </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10  -0.9392     0.3827  -2.454   0.0152 *  </span></span>
<span><span class="co">#&gt; gapUnits            -0.2496     0.0959  -2.603   0.0101 *  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.195 on 160 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.0881, Adjusted R-squared:  0.071 </span></span>
<span><span class="co">#&gt; F-statistic: 5.152 on 3 and 160 DF,  p-value: 0.001995</span></span></code></pre></div>
<p>Interestingly, this time, <em>all three</em> predictors turn out to
be significant. The first two are in expected directions: having more
competitors leads to longer referential expressions, whereas more recent
mentions makes the form smaller. However, the <code>gapUnits</code>
effect is in the opposite direction as we expect: The greater the gap,
the smaller the referential expression! This does not appear to make
sense. We will continue to improve this model in the following sections
to see what happens to <code>gapUnits</code>.</p>
</div>
<div class="section level3">
<h3 id="upgrading-gapwords">Upgrading <code>gapWords</code><a class="anchor" aria-label="anchor" href="#upgrading-gapwords"></a>
</h3>
<p>There’s an additional thing we could do. The <code>gapWords</code> in
Rezonator actually has a couple of problems; namely, it treats zeroes as
belonging to the position you put the <code>&lt;0&gt;</code> in (which
is arbitrary), and it counts non-words such as pauses, breaths or
laughter, which you might not want to count. Let’s try to use the
<code>rezonateR</code> function <code><a href="../reference/trackPrevContext.html">tokensToLastMention()</a></code>
instead to deal with these issues. We can treat <code>&lt;0&gt;</code>
as belonging to the end of the intonation unit they are annotated at,
and define <code>docWordSeqLast</code> as the token sequence used in
calculation, thus discounting non-words:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>gapWordsNew <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">tokensToLastMention</a></span><span class="op">(</span>tokenOrder <span class="op">=</span> <span class="va">docWordSeqLast</span>,</span>
<span>                                               unitDF <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span>,</span>
<span>                                               zeroProtocol <span class="op">=</span> <span class="st">"unitFinal"</span>,</span>
<span>                                               zeroCond <span class="op">=</span> <span class="op">(</span><span class="va">text</span> <span class="op">==</span> <span class="st">"&lt;0&gt;"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we can put this new <code>gapWords</code> into the model:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass2_model5</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapWords</span> <span class="op">!=</span> <span class="st">"N/A"</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapUnits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">gapUnits</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span> <span class="op">+</span> <span class="va">gapWordsNew</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass2_model5</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10 + </span></span>
<span><span class="co">#&gt;     gapWordsNew, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -9.957 -4.293 -2.640 -0.134 40.694 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)   </span></span>
<span><span class="co">#&gt; (Intercept)         5.28530    1.66172   3.181  0.00178 **</span></span>
<span><span class="co">#&gt; noCompetitors       1.55544    0.69390   2.242  0.02641 * </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10 -0.55027    0.37362  -1.473  0.14283   </span></span>
<span><span class="co">#&gt; gapWordsNew        -0.04628    0.04262  -1.086  0.27920   </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 9.225 on 155 degrees of freedom</span></span>
<span><span class="co">#&gt;   (5 observations deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.06179,    Adjusted R-squared:  0.04364 </span></span>
<span><span class="co">#&gt; F-statistic: 3.403 on 3 and 155 DF,  p-value: 0.01927</span></span></code></pre></div>
<p>This has no significant effect, and indeed takes away the
significance of <code>noPrevMentionsIn10</code> too.</p>
</div>
</div>
<div class="section level2">
<h2 id="pass-3-full-analysis">Pass 3: Full analysis<a class="anchor" aria-label="anchor" href="#pass-3-full-analysis"></a>
</h2>
<div class="section level3">
<h3 id="merging-chunks">Merging chunks<a class="anchor" aria-label="anchor" href="#merging-chunks"></a>
</h3>
<p>You have likely suspected by now that there is something wrong with
our <code>gapUnits</code> measure. And you would be correct! There
<em>is</em> a mistake in how we have been approaching these
calculations.</p>
<p>Let’s look at some cases where <code>gapUnits</code> is very small,
but <code>charCount</code> is mysteriously very large, and see what’s
wrong with them. We’ll set the cutoff for <code>gapUnits</code> at 1,
and the cutoff for <code>charCount</code> at 20.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">gapUnits</span> <span class="op">&lt;=</span> <span class="fl">1</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 40</span></span></span>
<span><span class="co">#&gt;    id      doc   chain sourc…¹ token gapWo…² charC…³ token…⁴ gapUn…⁵ kind  place</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 32B3B0… sbc0… 2053… 848F6D… 5B85… 6            31       6 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 351976… sbc0… 34F8… 1AAB2E… 1895… 2            32       6 0       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7F10C1… sbc0… 1AE4… 1C2B68… 55AD… 7            40      10 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 13BC3A… sbc0… 1AE4… F4B4FA… 1034… 3            50      11 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> EAB21F… sbc0… 220E… 35CEA4… F0DC… 5            30       5 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1B4827… sbc0… 1A6A… 2CCA2A… 3304… 9            37       8 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 16CD01… sbc0… 302C… 89F6D6… 109B… 3            23       4 0       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 36A2C1… sbc0… 5C99… 28D9D4… 33FB… 8            45       8 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 129168… sbc0… 22EB… 1709EB… 2C2F… 4            29       7 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 231F6E… sbc0… 22EB… 1B0F48… 2A38… 2            29       5 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 2B6BFA… sbc0… 2C47… 387F19… 23A1… 2            35       4 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 1D420E… sbc0… 14CE… AD003B… 3342… 5            31       6 1       <span style="color: #949494;">""</span>    <span style="color: #949494;">""</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with 29 more variables: text &lt;chr&gt;, transcript &lt;chr&gt;, endNote &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   order &lt;chr&gt;, negPlace &lt;chr&gt;, corpusSeq &lt;chr&gt;, pSentOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   POS_dft &lt;chr&gt;, tokenSeq &lt;chr&gt;, chunkType &lt;chr&gt;, turnOrder &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   largerChunk &lt;chr&gt;, tokenOrderFirst &lt;dbl&gt;, tokenOrderLast &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   docTokenSeqFirst &lt;dbl&gt;, docTokenSeqLast &lt;dbl&gt;, chainCreateSeq &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   name &lt;chr&gt;, chainSize &lt;dbl&gt;, layer &lt;chr&gt;, wordOrderFirst &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   wordOrderLast &lt;dbl&gt;, docWordSeqFirst &lt;dbl&gt;, docWordSeqLast &lt;dbl&gt;, …</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ Use `colnames()` to see all variable names</span></span></span></code></pre></div>
<p>Notice that some of these do not seem to be actual referential
expressions. Some of these are legitimate; for example, <em>nobody fucks
with my lifestyle</em> happens to have been referred to by a
cataphorical <em>it</em>:</p>
<div class="figure">
<img src="img/sample_fucks.PNG" alt=""><p class="caption">Figure 5</p>
</div>
<p>However, <em>(…) in self assertiveness ,</em> is an error. The
problem is that in Rezonator, it is not possible to create chunks that
span multiple units. We can only create individual chunks for each unit.
So in this screenshot, <em>a real good lesson for them ,</em>, <em>too
,</em>, and <em>(…) in self assertiveness ,</em> are three separate
chunks, when they should really only be a single chunk:</p>
<div class="figure">
<img src="img/sample_multiline.PNG" alt=""><p class="caption">Figure 6</p>
</div>
<p>This created a situation where <em>(…) in self assertiveness</em> is
mistakenly taken as long referential expression that occurred right
after a previous mention <em>too ,</em>.</p>
<p><code>rezonateR</code> is equipped with the ability to combine
several chunks inside the file into one larger chunk. Before we do this,
though, we need to spice up our data frames with information from the
trees, which will provide us with some of the information helpful for
merging chunks together. This will also be helpful for other types of
operations later on too, so let’s take a look at this feature.</p>
<div class="section level4">
<h4 id="adding-tree-information">Adding tree information<a class="anchor" aria-label="anchor" href="#adding-tree-information"></a>
</h4>
<p>Inside Rezonator, there are no direct links between trees and
entities like tracks and chunks. The function
<code><a href="../reference/getAllTreeCorrespondences.html">getAllTreeCorrespondences()</a></code> adds a column
<code>treeEntry</code> to various tables, which gives the ID of the
corresponding entry in the table <code>treeEntryDF</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/getAllTreeCorrespondences.html">getAllTreeCorrespondences</a></span><span class="op">(</span><span class="va">rez007</span>, entity <span class="op">=</span> <span class="st">"track"</span><span class="op">)</span></span>
<span><span class="co">#&gt; There is more than one tree entry match for the token 37EFCBECFD691. I will take the first match.</span></span>
<span><span class="co">#&gt; There is more than one tree entry match for the token 12D67756890C1. I will take the first match.</span></span>
<span><span class="co">#&gt; There is more than one tree entry match for the token 152560A5DE6AC. I will take the first match.</span></span>
<span><span class="co">#&gt; There is more than one tree entry match for the chunk 210FB26A315A. I will take the first match.</span></span>
<span><span class="co">#&gt; There is more than one tree entry match for the chunk 22273255D825D. I will take the first match.</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">tokenDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">treeEntry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text  treeEntry      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 31F282855E95E (...) <span style="color: #949494;">""</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 363C1D373B2F7 God   <span style="color: #949494;">""</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 3628E4BD4CC05 ,     <span style="color: #949494;">""</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 37EFCBECFD691 I     <span style="color: #949494;">"</span>E5564F08F4F8<span style="color: #949494;">"</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 12D67756890C1 said  <span style="color: #949494;">"</span>29A7D8B395830<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 936363B71D59  I     <span style="color: #949494;">"</span>163E211526284<span style="color: #949494;">"</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">$</span><span class="va">refexpr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">treeEntry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text                                     treeEntry     </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 35E3E0AB6803A Stay up late                             <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 1F6B5F0B3FF59 the purpose of getting up in the morning <span style="color: #949494;">"</span>5195D71DEA12<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 24FE2B219BD21 getting up in the morning                <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 158B579C1BA49 the morning                              <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2B6521E881365 all this other shit                      <span style="color: #949494;">""</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 5B854594DD34  the way (...) they were feeling          <span style="color: #949494;">""</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">treeEntry</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text              treeEntry      </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1096E4AFFFE65 I                 <span style="color: #949494;">"</span>E5564F08F4F8<span style="color: #949494;">"</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 92F20ACA5F06  I                 <span style="color: #949494;">"</span>163E211526284<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7E5BB65072C   was n't gon na do <span style="color: #949494;">"</span>35B1DC6EA25E5<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1F74D2B049FA4 this              <span style="color: #949494;">"</span>6FB5A1CE1B70<span style="color: #949494;">"</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2485C4F740FC0 &lt;0&gt;               <span style="color: #949494;">"</span>277C335C33462<span style="color: #949494;">"</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1BF2260B4AB78 Stay up late      <span style="color: #949494;">""</span></span></span></code></pre></div>
<p>This will be useful later on for other things as well, not just for
merging chunks.</p>
</div>
<div class="section level4">
<h4 id="mergechunkswithtree-and-mergechunkswithids">
<code>mergeChunksWithTree()</code> and
<code>mergeChunksWithIDs()</code><a class="anchor" aria-label="anchor" href="#mergechunkswithtree-and-mergechunkswithids"></a>
</h4>
<p>There are two functions for merging chunks in
<code>rezonateR</code>:</p>
<ul>
<li>
<code><a href="../reference/mergeChunksWithTree.html">mergeChunksWithTree()</a></code>: If there is a treeEntry that
corresponds to the concatenation of multiple chunks, then we merge those
chunks.</li>
<li>
<code><a href="../reference/mergeChunksWithIDs.html">mergeChunksWithIDs()</a></code>: We merge chunks by assigning IDs
to individual chunks that indicate the merged chunk it is supposed to
belong to. In this dataset, this is done in the field
<code>largerChunk</code> on chunks. For example, the first chunk you
create this way may have the ID 1, the second chunk 2, the third chunk 3
and so on. In this case, all the component chunks of the first complex
chunk should have the value <code>1</code> for <code>largerChunk</code>
and so on.</li>
</ul>
<p>The new chunks will be added to the bottom of <code>chunkDF</code>.
In addition, <code>chunkDF</code> will have an extra column
<code>combinedChunk</code> giving information about chunk
combinations:</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/mergeChunksWithTree.html">mergeChunksWithTree</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">)</span></span>
<span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/mergeChunksWithIDs.html">mergeChunksWithIDs</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="st">"largerChunk"</span><span class="op">)</span></span>
<span><span class="co">#Show combined referential expressions</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">$</span><span class="va">refexpr</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">combinedChunk</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">combinedChunk</span><span class="op">)</span> <span class="co">#Showing only combined chunks and their members</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 3</span></span></span>
<span><span class="co">#&gt;    id            text                                                    combi…¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                                   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 17F9B5FA4252A the only way it 's gon na work ,                        |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 33044BB3F044  is if we have respect for one another                   |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> DDF62DAF4C20  (H) &lt;0&gt; going to (...) our parents ,                    |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 33FBE08224498 and (...) &lt;0&gt; complaining about one another ,           |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2C2FB52C1A11  a real good lesson for them ,                           |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> E818EBA6CB78  too ,                                                   |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 2A382D1098989 (...) in self assertiveness ,                           |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> iDSKjR85VQnZJ the only way it 's gon na work , is if we have respect… combin…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1afkSI5tVOvWD (H) &lt;0&gt; going to (...) our parents , and (...) &lt;0&gt; com… combin…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> RvWKwshmobSLJ a real good lesson for them , too , (...) in self asse… combin…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​combinedChunk</span></span></span></code></pre></div>
<p><code><a href="../reference/mergedChunksToTrack.html">mergedChunksToTrack()</a></code> puts this information in the
<code>trackDF</code> too:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="fu"><a href="../reference/mergedChunksToTrack.html">mergedChunksToTrack</a></span><span class="op">(</span><span class="va">rez007</span>, <span class="st">"default"</span><span class="op">)</span></span>
<span><span class="co">#Show combined track members</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">combinedChunk</span> <span class="op">!=</span> <span class="st">""</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">text</span>, <span class="va">combinedChunk</span><span class="op">)</span> <span class="co">#Showing only combined chunks and their members</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 4</span></span></span>
<span><span class="co">#&gt;    id            name                           text                     combi…¹</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 24AF3536F90A3 having respect for one another the only way it 's gon … |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1B482778AB561 having respect for one another is if we have respect f… |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 33520A5F1B256 Trail 81                       (H) &lt;0&gt; going to (...) … |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 36A2C171D5FFE Trail 81                       and (...) &lt;0&gt; complaini… |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 129168B539994 weekly house meetings          a real good lesson for … |infom…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 144636EDDE11B weekly house meetings          too ,                    |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 231F6E448A5E7 weekly house meetings          (...) in self assertive… |membe…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> qSUHs76Octd4Z having respect for one another the only way it 's gon … combin…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> B2kUg0sO15yen Trail 81                       (H) &lt;0&gt; going to (...) … combin…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> yZ2m09xbJNTfc weekly house meetings          a real good lesson for … combin…</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># … with abbreviated variable name ¹​combinedChunk</span></span></span></code></pre></div>
<p>Using magic, <code>rezonateR</code> automatically calculates the
values of fields like <code>noCompetitors</code> when you combine
chunks, so you don’t need to worry about recalculating anything for the
merged chunks.</p>
</div>
</div>
<div class="section level3">
<h3 id="gapunits-take-two">
<code>gapUnits</code>, take two<a class="anchor" aria-label="anchor" href="#gapunits-take-two"></a>
</h3>
<p>Now that we have merged some of these chunks, it’s time to redo the
<code>gapUnits</code> value. We can do this by using the
<code><a href="../reference/trackPrevContext.html">unitsToLastMention()</a></code> function, and setting the value of
<code>exclFrag</code> to <code>TRUE</code> (i.e. excluding fragments of
chunks) and <code>nonFragmentMember</code> to the rows that do not have
the string <code>"member"</code> in <code>combinedChunk</code>:</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>gapUnitsNew <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">unitsToLastMention</a></span><span class="op">(</span>exclFrag <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                               nonFragmentMember <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">combinedChunk</span>, <span class="st">"member"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>This new value <code>gapUnitsNew</code> has an <code>NA</code> value
for fragments of chunks, and also ignores them when calculating
<code>gapUnits</code>. Let’s try to plot the relationship between
<code>gapUnitsNew</code> and <code>charCount</code> again:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>gapUnitsNew <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">gapUnitsNew</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_count.html" class="external-link">geom_count</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-28-1.png" width="700"></p>
<p>While we still can’t see the expected effect, some of the outliers on
the top left of the graph are now gone.</p>
<p>The <code>noPrevMentionsIn10</code> and <code>noCompetitors</code>
columns can also be redone to ignore fragments:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>noPrevMentionsIn10 <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">countPrevMentions</a></span><span class="op">(</span><span class="fl">10</span>,</span>
<span>                                    exclFrag <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                    nonFragmentMember <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">combinedChunk</span>, <span class="st">"member"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>noCompetitors <span class="op">=</span> <span class="fu"><a href="../reference/countCompete.html">countCompetitors</a></span><span class="op">(</span>windowSize <span class="op">=</span> <span class="fl">10</span>, between <span class="op">=</span> <span class="cn">F</span>,</span>
<span>                                                exclFrag <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                               nonFragmentMember <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">combinedChunk</span>, <span class="st">"member"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now with the corrected data, let’s try to refit the linear model:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass3_model1</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnitsNew</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass3_model1</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10 + </span></span>
<span><span class="co">#&gt;     gapUnitsNew, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;    Min     1Q Median     3Q    Max </span></span>
<span><span class="co">#&gt; -8.685 -3.870 -2.715 -0.024 42.289 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)         6.63316    1.63764   4.050 8.15e-05 ***</span></span>
<span><span class="co">#&gt; noCompetitors       1.12380    0.64186   1.751   0.0820 .  </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10 -0.81518    0.36732  -2.219   0.0280 *  </span></span>
<span><span class="co">#&gt; gapUnitsNew        -0.15704    0.08438  -1.861   0.0647 .  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 8.258 on 151 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.06287,    Adjusted R-squared:  0.04425 </span></span>
<span><span class="co">#&gt; F-statistic: 3.377 on 3 and 151 DF,  p-value: 0.02</span></span></code></pre></div>
<p>This time, <code>noCompetitors</code> is no longer a good predictor.
The coefficient of <code>gapUnitsNew</code> is still in the ‘wrong’
direction, since a larger <code>gapUnitsNew</code> still leads to a
smaller referential expression, but the effect is not significant any
more.</p>
<p>Is there any way we can improve on this model a little more? Let’s
consider the cases with small <code>gapUnits</code> but large character
counts again. It turns out that many of them are
<strong>predicates</strong> of copular clauses, like the following
example, which has the very long expression <em>what I’m gonna tell
him</em> coreferential to the subject <em>that</em>:</p>
<div class="figure">
<img src="img/sample_pred.PNG" alt=""><p class="caption">Figure 1</p>
</div>
<p>On the other hand, very few of these are subjects. This suggests that
it will be useful to add information about grammatical relations.
Subjects are likely to be biased towards shorter character counts, and
predicates towards longer ones. The two following sections will add
these elements. First we will add the <code>Relation</code> predictor,
which is annotated in the data and tells whether a referential
expression is the subject of a clause. Then we write code to
automatically guess whether something is a predicate.</p>
</div>
<div class="section level3">
<h3 id="adding-information-about-verbs-and-argument-structure">Adding information about verbs and argument structure<a class="anchor" aria-label="anchor" href="#adding-information-about-verbs-and-argument-structure"></a>
</h3>
<p>Now let’s add the <code>Relation</code> variable, which determines
whether a certain referential expression is the subject of a verb, a
factor frequently argued to be increasing accessibility. We use
<code><a href="../reference/acFieldForeign.html">addFieldForeign()</a></code>, which belongs to the EasyEdit family of
functions covered in <code><a href="../articles/edit_easyEdit.html">vignette("edit_easyEdit")</a></code>. Recall that
we’ve put a <code>treeEntry</code> column in <code>trackDF</code> that
gives the ID of the corresponding tree entry. The following code looks
into <code>treeEntryDF</code>, finds the <code>Relation</code> value
corresponding to a <code>treeEntry</code>, and adds it to
<code>trackDF</code>, allowing us to know whether each referential
expression is a subject:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="va">rez007</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/acFieldForeign.html">addFieldForeign</a></span><span class="op">(</span><span class="st">"track"</span>, <span class="st">"default"</span>, <span class="st">"treeEntry"</span>, <span class="st">"default"</span>, <span class="st">"treeEntry"</span>, <span class="st">"Relation"</span>, <span class="st">"Relation"</span>, fieldaccess <span class="op">=</span> <span class="st">"foreign"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">track</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">chain</span>, <span class="va">text</span>, <span class="va">treeEntry</span>, <span class="va">Relation</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 5</span></span></span>
<span><span class="co">#&gt;   id            chain         text              treeEntry       Relation</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1096E4AFFFE65 278D0D84814BC I                 <span style="color: #949494;">"</span>E5564F08F4F8<span style="color: #949494;">"</span>  <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 92F20ACA5F06  278D0D84814BC I                 <span style="color: #949494;">"</span>163E211526284<span style="color: #949494;">"</span> Subj    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7E5BB65072C   2B670736C6823 was n't gon na do <span style="color: #949494;">"</span>35B1DC6EA25E5<span style="color: #949494;">"</span> <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1F74D2B049FA4 2A01379C5D049 this              <span style="color: #949494;">"</span>6FB5A1CE1B70<span style="color: #949494;">"</span>  <span style="color: #BB0000;">NA</span>      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2485C4F740FC0 278D0D84814BC &lt;0&gt;               <span style="color: #949494;">"</span>277C335C33462<span style="color: #949494;">"</span> Subj    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1BF2260B4AB78 2A01379C5D049 Stay up late      <span style="color: #949494;">""</span>              <span style="color: #BB0000;">NA</span></span></span></code></pre></div>
<p>We can also replace the <code>NA</code> values in
<code>Relation</code> by <code>"NonSubj"</code>, and turn it into a
factor with <code><a href="../reference/stringToFactor.html">stringToFactor()</a></code> so that it can be used in
modelling:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>Relation <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html" class="external-link">coalesce</a></span><span class="op">(</span><span class="va">Relation</span>, <span class="st">"NonSubj"</span><span class="op">)</span>, fieldaccess <span class="op">=</span> <span class="st">"flex"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/stringToFactor.html">stringToFactor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Relation"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now plot the <code>charCount</code> values of subjects and
non-subjects:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Relation</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-33-1.png" width="700"></p>
<p>The pattern overwhelmingly supports our hypothesis. Now let’s see
what <code>Relation</code> turns up if we put it in the linear
model:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass3_model2</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnitsNew</span> <span class="op">+</span> <span class="va">Relation</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass3_model2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10 + </span></span>
<span><span class="co">#&gt;     gapUnitsNew + Relation, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.380  -4.553  -0.829   1.357  39.988 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)         9.81517    1.68458   5.826 3.33e-08 ***</span></span>
<span><span class="co">#&gt; noCompetitors       0.67561    0.61031   1.107   0.2701    </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10 -0.59232    0.34818  -1.701   0.0910 .  </span></span>
<span><span class="co">#&gt; gapUnitsNew        -0.13622    0.07934  -1.717   0.0881 .  </span></span>
<span><span class="co">#&gt; RelationSubj       -5.93369    1.28434  -4.620 8.20e-06 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.752 on 150 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1796, Adjusted R-squared:  0.1577 </span></span>
<span><span class="co">#&gt; F-statistic:  8.21 on 4 and 150 DF,  p-value: 5.151e-06</span></span></code></pre></div>
<p>As we can see, subjects are likely to be far shorter than
non-subjects. The effects of the other factors are gone in this
model.</p>
</div>
<div class="section level3">
<h3 id="adding-the-effect-of-predicatehood">Adding the effect of predicatehood<a class="anchor" aria-label="anchor" href="#adding-the-effect-of-predicatehood"></a>
</h3>
<p>We can now add a variable to pick out predicates. There’s a quick and
dirty way to guess which referential expressions are predicates: We can
pick out those expressions that are arguments of copulas, i.e. have a
copula in the column <code>verbText</code>, and also are not subjects.
This will incorrectly pick out adjuncts of copula clauses, but those are
infrequent enough in our sample that we can get away with it.</p>
<p>In addition, referential expressions that don’t belong to any verb
are often also predicate-like in behaviour, such as the multiline chunk
we’ve seen before:</p>
<div class="figure">
<img src="img/sample_multiline.PNG" alt=""><p class="caption">Figure</p>
</div>
<p>So we can also include them as ‘predicates’ as good measure. Let’s
call the resulting column <code>isPredOrFree</code>, with ‘free’ meaning
‘free from a verb’. (Note that this incorrectly picks out phrases that
are parts of prepositional phrases as well, but again, there are few
enough of these that we can get away with it.)</p>
<p>The first step in this process is to add information about the verb
to the <code>trackDF</code>. The following code adds two columns,
<code>verbID</code> and <code>verbText</code>, to the
<code>trackDF</code>, which tell us the chunk ID and text of the verb
that the referential expression depends on (for example, in <em>I saw
you</em>, the referential expressions <em>I</em> and <em>you</em> would
contain information about <em>saw</em>). This process is a bit
complicated; see <code><a href="../articles/track.html">vignette("track")</a></code> for a more detailed
explanation of what’s going on.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span> <span class="op">=</span> <span class="va">rez007</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/acFieldForeign.html">addFieldForeign</a></span><span class="op">(</span><span class="st">"track"</span>, <span class="st">"default"</span>, <span class="st">"treeEntry"</span>, <span class="st">"default"</span>, <span class="st">"treeEntry"</span>, <span class="st">"treeParent"</span>, <span class="st">"parent"</span>, fieldaccess <span class="op">=</span> <span class="st">"foreign"</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_left_join.html">rez_left_join</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">chunkDF</span><span class="op">$</span><span class="va">verb</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">treeEntry</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>treeParent <span class="op">=</span> <span class="st">"treeEntry"</span><span class="op">)</span>,</span>
<span>                suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_verb"</span><span class="op">)</span>,</span>
<span>                df2Address <span class="op">=</span> <span class="st">"chunkDF/verb"</span>,</span>
<span>                fkey <span class="op">=</span> <span class="st">"treeParent"</span>,</span>
<span>                df2key <span class="op">=</span> <span class="st">"treeEntry"</span>,</span>
<span>                rezrObj <span class="op">=</span> <span class="va">rez007</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename</a></span><span class="op">(</span>verbID <span class="op">=</span> <span class="va">id_verb</span>, verbText <span class="op">=</span> <span class="va">text_verb</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">treeParent</span>, <span class="va">verbID</span>, <span class="va">verbText</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 4</span></span></span>
<span><span class="co">#&gt;    id            treeParent    verbID        verbText         </span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1096E4AFFFE65 3005263A8352B vM9B6ctW0R2Po said             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 92F20ACA5F06  35B1DC6EA25E5 744AD104FE64  was n't gon na do</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7E5BB65072C   <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1F74D2B049FA4 35B1DC6EA25E5 744AD104FE64  was n't gon na do</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2485C4F740FC0 27760709F2C9B 15B9BB5D5086C Stay             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1BF2260B4AB78 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6B37B5A80F2A  37FF92CF72A49 1A14BB68EDAC9 defeats          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 259C2C2979B6C 37FF92CF72A49 1A14BB68EDAC9 defeats          </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1D1F2B7054E32 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1FA3806680C84 <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4B32FD84BA10  1CC3629361ED5 2CCD5F5A950BE know             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 3098AB24A0FA6 1CAE658BC6B04 1F1135429F347 's               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2D5885FCA1E15 1CAE658BC6B04 1F1135429F347 's               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1C311FD331AC4 3342A614FCFB  30F18BABDB83C do n't           </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2E01153F693D3 BCC81F077D99  94188DEA38BB  is               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 28CFE0272CE1C 6B9C62B7793B  13A37EC5064A2 do n't stay      </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 24229602BDC4C 23BEEC722C8A0 29C877785FC4B 'm               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1A598AE39592B <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>            <span style="color: #BB0000;">NA</span>               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 38C628AB4DA4D EC3E7F082CF3  1981C9A8D5DD8 do               </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 36B8918BB6E64 EC3E7F082CF3  1981C9A8D5DD8 do</span></span></code></pre></div>
<p>Here’s the code for getting <code>verbText</code> from this:</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>isPredOrFree <span class="op">=</span> <span class="op">(</span><span class="op">(</span></span>
<span>  <span class="va">verbText</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"is"</span>, <span class="st">"was"</span>, <span class="st">"were"</span>, <span class="st">"are"</span>, <span class="st">"am"</span>, <span class="st">"'s"</span>, <span class="st">"'m"</span>, <span class="st">"'re"</span><span class="op">)</span> <span class="op">&amp;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Relation</span><span class="op">)</span></span>
<span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">verbText</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/coalesce.html" class="external-link">coalesce</a></span><span class="op">(</span><span class="cn">F</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now let’s compare the character counts of referential expressions
that are predicates or free, versus those that are not:</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">isPredOrFree</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-37-1.png" width="700"></p>
<p>The tendency should now be clear, so let’s add
<code>isPredOrFree</code> to the model:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass3_model2</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnitsNew</span> <span class="op">+</span> <span class="va">Relation</span> <span class="op">+</span> <span class="va">isPredOrFree</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass3_model2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevMentionsIn10 + </span></span>
<span><span class="co">#&gt;     gapUnitsNew + Relation + isPredOrFree, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.681  -4.640  -0.741   1.436  39.725 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                    Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)          8.8092     2.0243   4.352 2.49e-05 ***</span></span>
<span><span class="co">#&gt; noCompetitors        0.6327     0.6126   1.033  0.30332    </span></span>
<span><span class="co">#&gt; noPrevMentionsIn10  -0.6088     0.3489  -1.745  0.08307 .  </span></span>
<span><span class="co">#&gt; gapUnitsNew         -0.1400     0.0795  -1.761  0.08035 .  </span></span>
<span><span class="co">#&gt; RelationSubj        -4.9764     1.6701  -2.980  0.00337 ** </span></span>
<span><span class="co">#&gt; isPredOrFreeTRUE     1.5099     1.6823   0.898  0.37089    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.757 on 149 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.184,  Adjusted R-squared:  0.1566 </span></span>
<span><span class="co">#&gt; F-statistic: 6.721 on 5 and 149 DF,  p-value: 1.123e-05</span></span></code></pre></div>
<p>Unfortunately, <code>isPredOrFree</code> does not turn out to be a
significant predictor.</p>
</div>
<div class="section level3">
<h3 id="splitting-up-noprevsubjmentions">Splitting up <code>noPrevSubjMentions</code><a class="anchor" aria-label="anchor" href="#splitting-up-noprevsubjmentions"></a>
</h3>
<p>Let’s see if we can improve upon the model in any more ways. The
first thing we could do is to split up <code>noPrevMentionsIn10</code>.
It is often proposed in the literature that subjects are more accessible
than other types of arguments, and when the previous mention is a
subject, the expression will subsequently be more accessible as well. So
we could split up previous mentions into previous subjects and previous
non-subjects.</p>
<p>The function <code><a href="../reference/trackPrevContext.html">countPrevMentionsIf()</a></code> counts the number of
times that a referent was mentioned previously in a specified window of
units, along with the <code>TidyRez</code> function
<code><a href="../reference/rez_mutate.html">rez_mutate()</a></code> (note that for non-subjects, we allow
<code>Relation</code> to be <code>NA</code>):</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>noPrevSubjMentionsIn10 <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">countPrevMentionsIf</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">Relation</span> <span class="op">==</span> <span class="st">"Subj"</span>, exclFrag <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                               nonFragmentMember <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">combinedChunk</span>, <span class="st">"member"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             noPrevNonSubjMentionsIn10 <span class="op">=</span> <span class="fu"><a href="../reference/trackPrevContext.html">countPrevMentionsIf</a></span><span class="op">(</span><span class="fl">10</span>, <span class="va">Relation</span> <span class="op">!=</span> <span class="st">"Subj"</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">Relation</span><span class="op">)</span>, exclFrag <span class="op">=</span> <span class="cn">T</span>,</span>
<span>                                               nonFragmentMember <span class="op">=</span> <span class="op">!</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">combinedChunk</span>, <span class="st">"member"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">noPrevSubjMentionsIn10</span>, <span class="va">noPrevNonSubjMentionsIn10</span><span class="op">)</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html" class="external-link">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">20</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 3</span></span></span>
<span><span class="co">#&gt;    id            noPrevSubjMentionsIn10 noPrevNonSubjMentionsIn10</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                          <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>                     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1096E4AFFFE65                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 92F20ACA5F06                       0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 7E5BB65072C                        0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1F74D2B049FA4                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 2485C4F740FC0                      1                         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1BF2260B4AB78                      0                         1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 6B37B5A80F2A                       0                         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 259C2C2979B6C                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1D1F2B7054E32                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1FA3806680C84                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> 4B32FD84BA10                       0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> 3098AB24A0FA6                      1                         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> 2D5885FCA1E15                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> 1C311FD331AC4                      1                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> 2E01153F693D3                      2                         2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> 28CFE0272CE1C                      2                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> 24229602BDC4C                      3                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> 1A598AE39592B                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> 38C628AB4DA4D                      0                         0</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> 36B8918BB6E64                      2                         0</span></span></code></pre></div>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass3_model2</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevSubjMentionsIn10</span> <span class="op">+</span> <span class="va">noPrevNonSubjMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnitsNew</span> <span class="op">+</span> <span class="va">Relation</span> <span class="op">+</span> <span class="va">isPredOrFree</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass3_model2</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevSubjMentionsIn10 + </span></span>
<span><span class="co">#&gt;     noPrevNonSubjMentionsIn10 + gapUnitsNew + Relation + isPredOrFree, </span></span>
<span><span class="co">#&gt;     data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.545  -4.592  -0.794   1.092  38.985 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                8.41577    2.07922   4.048 8.31e-05 ***</span></span>
<span><span class="co">#&gt; noCompetitors              0.50297    0.63216   0.796  0.42752    </span></span>
<span><span class="co">#&gt; noPrevSubjMentionsIn10    -0.77497    0.40096  -1.933  0.05518 .  </span></span>
<span><span class="co">#&gt; noPrevNonSubjMentionsIn10 -0.06687    0.73111  -0.091  0.92725    </span></span>
<span><span class="co">#&gt; gapUnitsNew               -0.12648    0.08117  -1.558  0.12134    </span></span>
<span><span class="co">#&gt; RelationSubj              -4.69211    1.70534  -2.751  0.00668 ** </span></span>
<span><span class="co">#&gt; isPredOrFreeTRUE           1.68974    1.69740   0.995  0.32113    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.765 on 148 degrees of freedom</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1879, Adjusted R-squared:  0.155 </span></span>
<span><span class="co">#&gt; F-statistic: 5.708 on 6 and 148 DF,  p-value: 2.305e-05</span></span></code></pre></div>
<p>As we can now see, non-subjects have no effect at all, although the
effect for subjects nears significance.</p>
</div>
<div class="section level3">
<h3 id="adding-information-about-number">Adding information about number<a class="anchor" aria-label="anchor" href="#adding-information-about-number"></a>
</h3>
<p>Let’s take a final crack at the problem by seeing whether number
(singular vs plural) has an effect on referential choice. Our steps are
as follows:</p>
<ol style="list-style-type: decimal">
<li>We will first take a guess at what the number of a track in
<code>rez007$trackDF</code> is using a set of simplistic rules based on
the linguistic form.</li>
<li>Then we export a <code>.csv</code> file from <code>rezonateR</code>,
and edit the automatic guesses in Microsoft Excel (or any other
spreadsheet program of your choice).</li>
<li>We then import the <code>.csv</code> file back into
<code>rezonateR</code> and update <code>rez007$trackDF</code> from the
imported file.</li>
</ol>
<p>Let’s say we want to annotate the number of the referential
expressions inside <code>trackDF$default</code>. A good approximation
will be to mark everything that ends with &lt;s&gt; as plural, along
with common plural pronouns and demonstratives, mark coordinate noun
phrases as plural, mark noun phrases with singular demonstratives as
singular, mark <em>you</em> as uncertain, and then mark the rest as
singular:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_mutate.html">rez_mutate</a></span><span class="op">(</span>number <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">" and "</span><span class="op">)</span> <span class="op">~</span> <span class="st">"pl"</span>,</span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_starts.html" class="external-link">str_ends</a></span><span class="op">(</span><span class="va">text</span>, <span class="st">"s"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"pl"</span>,</span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span>, <span class="st">"(these|those)"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"pl"</span>,</span>
<span>  <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html" class="external-link">str_detect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span>, <span class="st">"(this|that)"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"sg"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"we"</span>, <span class="st">"they"</span>, <span class="st">"us"</span>, <span class="st">"them"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"pl"</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">text</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"you"</span>, <span class="st">"&lt;0&gt;"</span><span class="op">)</span> <span class="op">~</span> <span class="st">"?"</span>,</span>
<span>  <span class="cn">T</span> <span class="op">~</span> <span class="st">"sg"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">name</span>, <span class="va">text</span>, <span class="va">number</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 4</span></span></span>
<span><span class="co">#&gt;   id            name            text              number</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1096E4AFFFE65 Mary            I                 sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 92F20ACA5F06  Mary            I                 sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7E5BB65072C   Trail 87        was n't gon na do sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1F74D2B049FA4 Staying up late this              pl    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2485C4F740FC0 Mary            &lt;0&gt;               ?     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1BF2260B4AB78 Staying up late Stay up late      sg</span></span></code></pre></div>
<p>Before we export this as a <code>.csv</code> for annotation, I would
like to add a column inside the <code>trackDF</code> that gives us the
transcription of the entire unit. It will be useful to be able to see
this column while making manual annotations, such as when dealing with
zero mentions. To simplify, we will just get the last unit even for
multi-line chunks. Here is the code. We are using
<code><a href="../reference/rez_left_join.html">rez_left_join()</a></code>, another TidyRez function, and extracting
the <code>text</code> column of the unit whose <code>unitSeq</code> in
<code>unitDF</code> corresponds to the <code>unitSeqLast</code> of a
referential expression in <code>trackDF</code>:</p>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_left_join.html">rez_left_join</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">unitDF</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="../reference/rez_select.html">rez_select</a></span><span class="op">(</span><span class="va">unitSeq</span>, <span class="va">text</span><span class="op">)</span>,</span>
<span>                by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>unitSeqLast <span class="op">=</span> <span class="st">"unitSeq"</span><span class="op">)</span>,</span>
<span>                suffix <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">"_unit"</span><span class="op">)</span>,</span>
<span>                df2key <span class="op">=</span> <span class="st">"unitSeq"</span>,</span>
<span>                rezrObj <span class="op">=</span> <span class="va">rez007</span>,</span>
<span>                df2Address <span class="op">=</span> <span class="st">"unitDF"</span>,</span>
<span>                fkey <span class="op">=</span> <span class="st">"unitSeqLast"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/rez_rename.html">rez_rename</a></span><span class="op">(</span>unitLastText <span class="op">=</span> <span class="va">text_unit</span><span class="op">)</span></span>
<span><span class="co">#&gt; Tip: When performed on a rezrDF inside a rezrObj, rez_rename is a potentially destructive action. It is NOT recommended to assign it back to a rezrDF inside a rezrObj. If you must do so, be careful to update all addresses from other DFs to this DF.</span></span></code></pre></div>
<p>We then write the <code>csv</code> file. We only export a subset of
the columns in the <code>trackDF</code> so that our screen is cleaner
and easier to work with:</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/rw.html">rez_write_csv</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span>, <span class="st">"rez007_refexpr.csv"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"id"</span>, <span class="st">"unitLastText"</span>, <span class="st">"tokenOrderLast"</span>, <span class="st">"text"</span>, <span class="st">"name"</span>, <span class="st">"number"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>An editing best practice is to copy the <code>.csv</code> file and
edit from the copy, rather from the <code>.csv</code> you export
directly. Figure 7 shows what the exported <code>.csv</code> looks like
in Excel:</p>
<div class="figure">
<img src="img/sample-excel.PNG" style="width:100.0%" alt=""><p class="caption">Figure 7</p>
</div>
<p>After editing the CSV in a spreadsheet program, we import it back
using <code><a href="../reference/rw.html">rez_read_csv()</a></code> (specifying the original
<code>rezrDF</code> makes the import processes smoother and less
error-prone):</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">changeDF</span> <span class="op">=</span> <span class="fu"><a href="../reference/rw.html">rez_read_csv</a></span><span class="op">(</span><span class="st">"rez007_refexpr_edited_sampleproj.csv"</span>, origDF <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we use the <code><a href="../reference/updateFromDF.html">updateFromDF()</a></code> function to change
the <code>number</code> column:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/updateFromDF.html">updateFromDF</a></span><span class="op">(</span><span class="va">changeDF</span>, changeCols <span class="op">=</span> <span class="st">"number"</span><span class="op">)</span></span>
<span><span class="co">#&gt;      </span></span>
<span><span class="co">#&gt; "id" </span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, <span class="va">text</span>, <span class="va">number</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6 × 3</span></span></span>
<span><span class="co">#&gt;   id            text              number</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> 1096E4AFFFE65 I                 sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> 92F20ACA5F06  I                 sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> 7E5BB65072C   was n't gon na do sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> 1F74D2B049FA4 this              pl    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> 2485C4F740FC0 &lt;0&gt;               sg    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> 1BF2260B4AB78 Stay up late      sg</span></span></code></pre></div>
<p>Now let’s graph the difference between the singulars and plurals in a
graph:</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">number</span>, y <span class="op">=</span> <span class="va">charCount</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="sample_proj_files/figure-html/unnamed-chunk-46-1.png" width="700">
Singulars seem to be more concentrated towards the smaller character
counts, but at the same time have more outliers that are very heavy.
Let’s put these in the model and see what happens:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pass3_model3</span> <span class="op">=</span> <span class="va">rez007</span><span class="op">$</span><span class="va">trackDF</span><span class="op">$</span><span class="va">default</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">gapUnitsNew</span><span class="op">)</span>, <span class="va">charCount</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">charCount</span> <span class="op">~</span> <span class="va">noCompetitors</span> <span class="op">+</span> <span class="va">noPrevSubjMentionsIn10</span> <span class="op">+</span> <span class="va">noPrevNonSubjMentionsIn10</span> <span class="op">+</span> <span class="va">gapUnitsNew</span> <span class="op">+</span> <span class="va">number</span> <span class="op">+</span> <span class="va">Relation</span> <span class="op">+</span> <span class="va">isPredOrFree</span>, <span class="va">.</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">pass3_model3</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; lm(formula = charCount ~ noCompetitors + noPrevSubjMentionsIn10 + </span></span>
<span><span class="co">#&gt;     noPrevNonSubjMentionsIn10 + gapUnitsNew + number + Relation + </span></span>
<span><span class="co">#&gt;     isPredOrFree, data = .)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residuals:</span></span>
<span><span class="co">#&gt;     Min      1Q  Median      3Q     Max </span></span>
<span><span class="co">#&gt; -10.130  -4.223  -0.800   1.143  39.699 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;                           Estimate Std. Error t value Pr(&gt;|t|)    </span></span>
<span><span class="co">#&gt; (Intercept)                8.59682    2.34783   3.662  0.00035 ***</span></span>
<span><span class="co">#&gt; noCompetitors              0.48025    0.64373   0.746  0.45684    </span></span>
<span><span class="co">#&gt; noPrevSubjMentionsIn10    -0.76665    0.39893  -1.922  0.05658 .  </span></span>
<span><span class="co">#&gt; noPrevNonSubjMentionsIn10 -0.22219    0.72488  -0.307  0.75964    </span></span>
<span><span class="co">#&gt; gapUnitsNew               -0.12723    0.08053  -1.580  0.11630    </span></span>
<span><span class="co">#&gt; numbersg                  -0.09464    1.68367  -0.056  0.95525    </span></span>
<span><span class="co">#&gt; RelationSubj              -4.62141    1.68078  -2.750  0.00672 ** </span></span>
<span><span class="co">#&gt; isPredOrFreeTRUE           1.43791    1.68077   0.856  0.39367    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual standard error: 7.651 on 146 degrees of freedom</span></span>
<span><span class="co">#&gt;   (1 observation deleted due to missingness)</span></span>
<span><span class="co">#&gt; Multiple R-squared:  0.1804, Adjusted R-squared:  0.1411 </span></span>
<span><span class="co">#&gt; F-statistic: 4.591 on 7 and 146 DF,  p-value: 0.0001155</span></span></code></pre></div>
<p>Whether the current mention is a subject continues to turn out to be
good predictors, and the noumber of previous subject mentions continues
to be close to significance. The rest of the predictors are not
significant, though some of them (particularly the number of competitors
and lookback distance i.e. <code>gapUnits</code>) may hold some promise
on a larger dataset. Grammatical number seems to be hopeless.</p>
</div>
</div>
<div class="section level2">
<h2 id="where-to-go-from-here">Where to go from here?<a class="anchor" aria-label="anchor" href="#where-to-go-from-here"></a>
</h2>
<p>This simple project shows most of the basic capabilities of
<code>rezonateR</code>, though it still leaves out a lot, such as
<em>reloads</em>, which allows you to update certain column
automatically after changing other columns.
<code><a href="../articles/overview.html">vignette("overview")</a></code> is a less topically focused overview
of the package, less focused on a single problem but covering more
topics. The series of tutorials starting from
<code><a href="../articles/import_save_basics.html">vignette("import_save_basics")</a></code> is based on the same dataset
as this tutorial, but covers most functionality of the package down to
the smallest details, and you can pick and choose topics from there to
read. Good luck!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Ryan Ka Yau Lai, John W Du Bois.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
